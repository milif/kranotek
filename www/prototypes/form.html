<!DOCTYPE html>
<html>
  <head>
    <title>Prototype</title>
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link href="../vendor/bootstrap/css/bootstrap.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../vendor/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">  
        
    
    
  </head>
  <body style="background: url(background.png); ">
  
    <div class="container-fluid">
        <h1>Form</h1>
        <div id="form" style="background: white;"></div>             
    </div>
    
    <link href="../css/b/form.css" rel="stylesheet">
    <link href="../css/b/loading.css" rel="stylesheet">
    <link href="../css/b/toolbarhover.css" rel="stylesheet">
    <link href="../css/b/effects.css" rel="stylesheet">
    <link href="../css/b/systemmsg.css" rel="stylesheet">
    <link href="../css/b/tooltip.css" rel="stylesheet">
    
    <script src="../vendor/jquery/jquery.js"></script>
    <script src="../vendor/underscore/underscore.js"></script>
    <script src="../vendor/backbone/backbone.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.js"></script>
    
    <script src="../src/App.js"></script>
    <script src="../src/RPC.js"></script>
    
    <script src="../src/view/button/Button.js"></script>
    
    <script src="../src/view/container/Container.js"></script>
    <script src="../src/view/container/ContainerRow.js"></script>
    
    <script src="../src/view/tooltip/Tooltip.js"></script>
    
    <script src="../src/view/form/Form.js"></script>
    <script src="../src/view/form/Field.js"></script>
    <script src="../src/view/form/FieldText.js"></script>
    <script src="../src/view/form/FieldTextarea.js"></script>
    <script src="../src/view/form/FieldCheckbox.js"></script>
    <script src="../src/view/form/FieldSelect.js"></script>
    
    <style>
        h1 .btn {
            margin-left: 15px;
            }
    </style>
    
    <script>
        
        App.env = {
            apiUrl: '../',
            apiUrlSuffix: '.php'
        }
        
        
        App.defineModel('ModelTest', {
            api: 'class',
            validateModel: function(attrs){
                var errors = [],
                    attr;
                
                attr = attrs.text;
                if(typeof attr !='undefined') {
                    if(attr.length < 4) {
                        errors.push({ name: 'text', msg: 'Название 4 и более символов'});
                    }
                }               
                
                return errors.length > 0 ? errors : null ;
            }    
        });        
        
        var Form = App.getView('Form'),
            FieldTextarea = App.getView('FieldTextarea'),
            FieldText = App.getView('FieldText'),
            FieldSelect = App.getView('FieldSelect'),
            FieldCheckbox = App.getView('FieldCheckbox'),
            Button = App.getView('Button'),
            ModelTest = App.getModel('ModelTest'),
            model = new ModelTest({
                'text': '',
                'textarea': 'test2',
                'select': 2,
                'checkbox': true
            }),
            form = new Form({
                legend: 'Legend',
                model: model
            })
                .add(new FieldText({
                    label: 'Text field',
                    name: 'text'
                }))
                .add(new FieldTextarea({
                    label: 'Textarea field',
                    name: 'textarea'
                }))
                .add(new FieldSelect({
                    label: 'Select field',
                    name: 'select',
                    options: {
                        1: 'Item 1',
                        2: 'Item 2',
                        3: 'Item 3'
                    }
                }))
                .add(new FieldCheckbox({
                    label: 'Checkbox field',
                    name: 'checkbox'
                }));
        
        $('#form').append(form.$el);
        $('h1').append(new Button({
            text: 'Сообщение об ошибке',
            click: function(){
                App.msg.alert({
                    title: 'Ошибка при сохранении формы!', 
                    text: 'Это тестовое сообщение. Сервис временно не доступен.'
                });
            }
        }).$el); 
    </script>
  </body>
</html>
