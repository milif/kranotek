(function(){function b(a,c,d){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;a._chain&&(a=a._wrapped);c._chain&&(c=c._wrapped);if(a.isEqual&&g.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&g.isFunction(c.isEqual))return c.isEqual(a);var i=k.call(a);if(i!=k.call(c))return!1;switch(i){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,e=!0;if("[object Array]"==i){if(f=a.length,e=f==c.length)for(;f--&&(e=f in a==f in c&&b(a[f],c[f],d)););}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var y in a)if(g.has(a,y)&&(f++,!(e=g.has(c,y)&&b(a[y],c[y],d))))break;if(e){for(y in c)if(g.has(c,y)&&!f--)break;
e=!f}}d.pop();return e}var e=this,a=e._,c={},d=Array.prototype,f=Object.prototype,h=d.slice,j=d.unshift,k=f.toString,m=f.hasOwnProperty,q=d.forEach,n=d.map,t=d.reduce,r=d.reduceRight,s=d.filter,u=d.every,p=d.some,l=d.indexOf,x=d.lastIndexOf,f=Array.isArray,v=Object.keys,z=Function.prototype.bind,g=function(a){return new B(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=g),exports._=g):e._=g;g.VERSION="1.3.3";var w=g.each=g.forEach=function(a,
b,d){if(null!=a)if(q&&a.forEach===q)a.forEach(b,d);else if(a.length===+a.length)for(var i=0,f=a.length;i<f&&!(i in a&&b.call(d,a[i],i,a)===c);i++);else for(i in a)if(g.has(a,i)&&b.call(d,a[i],i,a)===c)break};g.map=g.collect=function(a,b,c){var i=[];if(null==a)return i;if(n&&a.map===n)return a.map(b,c);w(a,function(a,d,f){i[i.length]=b.call(c,a,d,f)});a.length===+a.length&&(i.length=a.length);return i};g.reduce=g.foldl=g.inject=function(a,b,c,i){var d=2<arguments.length;null==a&&(a=[]);if(t&&a.reduce===
t)return i&&(b=g.bind(b,i)),d?a.reduce(b,c):a.reduce(b);w(a,function(a,f,H){d?c=b.call(i,c,a,f,H):(c=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return c};g.reduceRight=g.foldr=function(a,b,c,i){var d=2<arguments.length;null==a&&(a=[]);if(r&&a.reduceRight===r)return i&&(b=g.bind(b,i)),d?a.reduceRight(b,c):a.reduceRight(b);var f=g.toArray(a).reverse();i&&!d&&(b=g.bind(b,i));return d?g.reduce(f,b,c,i):g.reduce(f,b)};g.find=g.detect=function(a,b,c){var i;A(a,function(a,
d,f){if(b.call(c,a,d,f))return i=a,!0});return i};g.filter=g.select=function(a,b,c){var i=[];if(null==a)return i;if(s&&a.filter===s)return a.filter(b,c);w(a,function(a,d,f){b.call(c,a,d,f)&&(i[i.length]=a)});return i};g.reject=function(a,b,c){var i=[];if(null==a)return i;w(a,function(a,d,f){b.call(c,a,d,f)||(i[i.length]=a)});return i};g.every=g.all=function(a,b,i){var d=!0;if(null==a)return d;if(u&&a.every===u)return a.every(b,i);w(a,function(a,f,e){if(!(d=d&&b.call(i,a,f,e)))return c});return!!d};
var A=g.some=g.any=function(a,b,i){b||(b=g.identity);var d=!1;if(null==a)return d;if(p&&a.some===p)return a.some(b,i);w(a,function(a,f,e){if(d||(d=b.call(i,a,f,e)))return c});return!!d};g.include=g.contains=function(a,b){var c=!1;return null==a?c:l&&a.indexOf===l?-1!=a.indexOf(b):c=A(a,function(a){return a===b})};g.invoke=function(a,b){var c=h.call(arguments,2);return g.map(a,function(a){return(g.isFunction(b)?b||a:a[b]).apply(a,c)})};g.pluck=function(a,b){return g.map(a,function(a){return a[b]})};
g.max=function(a,b,c){if(!b&&g.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&g.isEmpty(a))return-Infinity;var i={computed:-Infinity};w(a,function(a,d,f){d=b?b.call(c,a,d,f):a;d>=i.computed&&(i={value:a,computed:d})});return i.value};g.min=function(a,b,c){if(!b&&g.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&g.isEmpty(a))return Infinity;var i={computed:Infinity};w(a,function(a,d,f){d=b?b.call(c,a,d,f):a;d<i.computed&&(i={value:a,computed:d})});return i.value};g.shuffle=
function(a){var b=[],c;w(a,function(a,i){c=Math.floor(Math.random()*(i+1));b[i]=b[c];b[c]=a});return b};g.sortBy=function(a,b,c){var i=g.isFunction(b)?b:function(a){return a[b]};return g.pluck(g.map(a,function(a,b,d){return{value:a,criteria:i.call(c,a,b,d)}}).sort(function(a,b){var c=a.criteria,i=b.criteria;return void 0===c?1:void 0===i?-1:c<i?-1:c>i?1:0}),"value")};g.groupBy=function(a,b){var c={},i=g.isFunction(b)?b:function(a){return a[b]};w(a,function(a,b){var d=i(a,b);(c[d]||(c[d]=[])).push(a)});
return c};g.sortedIndex=function(a,b,c){c||(c=g.identity);for(var i=0,d=a.length;i<d;){var f=i+d>>1;c(a[f])<c(b)?i=f+1:d=f}return i};g.toArray=function(a){return!a?[]:g.isArray(a)||g.isArguments(a)?h.call(a):a.toArray&&g.isFunction(a.toArray)?a.toArray():g.values(a)};g.size=function(a){return g.isArray(a)?a.length:g.keys(a).length};g.first=g.head=g.take=function(a,b,c){return null!=b&&!c?h.call(a,0,b):a[0]};g.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))};g.last=function(a,
b,c){return null!=b&&!c?h.call(a,Math.max(a.length-b,0)):a[a.length-1]};g.rest=g.tail=function(a,b,c){return h.call(a,null==b||c?1:b)};g.compact=function(a){return g.filter(a,function(a){return!!a})};g.flatten=function(a,b){return g.reduce(a,function(a,c){if(g.isArray(c))return a.concat(b?c:g.flatten(c));a[a.length]=c;return a},[])};g.without=function(a){return g.difference(a,h.call(arguments,1))};g.uniq=g.unique=function(a,b,c){var c=c?g.map(a,c):a,i=[];3>a.length&&(b=!0);g.reduce(c,function(c,d,
f){if(b?g.last(c)!==d||!c.length:!g.include(c,d))c.push(d),i.push(a[f]);return c},[]);return i};g.union=function(){return g.uniq(g.flatten(arguments,!0))};g.intersection=g.intersect=function(a){var b=h.call(arguments,1);return g.filter(g.uniq(a),function(a){return g.every(b,function(b){return 0<=g.indexOf(b,a)})})};g.difference=function(a){var b=g.flatten(h.call(arguments,1),!0);return g.filter(a,function(a){return!g.include(b,a)})};g.zip=function(){for(var a=h.call(arguments),b=g.max(g.pluck(a,"length")),
c=Array(b),i=0;i<b;i++)c[i]=g.pluck(a,""+i);return c};g.indexOf=function(a,b,c){if(null==a)return-1;var i;if(c)return c=g.sortedIndex(a,b),a[c]===b?c:-1;if(l&&a.indexOf===l)return a.indexOf(b);c=0;for(i=a.length;c<i;c++)if(c in a&&a[c]===b)return c;return-1};g.lastIndexOf=function(a,b){if(null==a)return-1;if(x&&a.lastIndexOf===x)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};g.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);for(var c=arguments[2]||1,
i=Math.max(Math.ceil((b-a)/c),0),d=0,f=Array(i);d<i;)f[d++]=a,a+=c;return f};var C=function(){};g.bind=function(a,b){var c,i;if(a.bind===z&&z)return z.apply(a,h.call(arguments,1));if(!g.isFunction(a))throw new TypeError;i=h.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,i.concat(h.call(arguments)));C.prototype=a.prototype;var d=new C,f=a.apply(d,i.concat(h.call(arguments)));return Object(f)===f?f:d}};g.bindAll=function(a){var b=h.call(arguments,1);0==b.length&&(b=g.functions(a));
w(b,function(b){a[b]=g.bind(a[b],a)});return a};g.memoize=function(a,b){var c={};b||(b=g.identity);return function(){var i=b.apply(this,arguments);return g.has(c,i)?c[i]:c[i]=a.apply(this,arguments)}};g.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};g.defer=function(a){return g.delay.apply(g,[a,1].concat(h.call(arguments,1)))};g.throttle=function(a,b){var c,i,d,f,e,y,h=g.debounce(function(){e=f=!1},b);return function(){c=this;i=arguments;d||
(d=setTimeout(function(){d=null;e&&a.apply(c,i);h()},b));f?e=!0:y=a.apply(c,i);h();f=!0;return y}};g.debounce=function(a,b,c){var i;return function(){var d=this,f=arguments;c&&!i&&a.apply(d,f);clearTimeout(i);i=setTimeout(function(){i=null;c||a.apply(d,f)},b)}};g.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};g.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments,0));return b.apply(this,c)}};g.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};g.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};g.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)g.has(a,c)&&(b[b.length]=c);return b};g.values=function(a){return g.map(a,g.identity)};g.functions=g.methods=function(a){var b=[],c;for(c in a)g.isFunction(a[c])&&b.push(c);return b.sort()};g.extend=function(a){w(h.call(arguments,
1),function(b){for(var c in b)a[c]=b[c]});return a};g.pick=function(a){var b={};w(g.flatten(h.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};g.defaults=function(a){w(h.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};g.clone=function(a){return!g.isObject(a)?a:g.isArray(a)?a.slice():g.extend({},a)};g.tap=function(a,b){b(a);return a};g.isEqual=function(a,c){return b(a,c,[])};g.isEmpty=function(a){if(null==a)return!0;if(g.isArray(a)||g.isString(a))return 0===
a.length;for(var b in a)if(g.has(a,b))return!1;return!0};g.isElement=function(a){return!!(a&&1==a.nodeType)};g.isArray=f||function(a){return"[object Array]"==k.call(a)};g.isObject=function(a){return a===Object(a)};g.isArguments=function(a){return"[object Arguments]"==k.call(a)};g.isArguments(arguments)||(g.isArguments=function(a){return!(!a||!g.has(a,"callee"))});g.isFunction=function(a){return"[object Function]"==k.call(a)};g.isString=function(a){return"[object String]"==k.call(a)};g.isNumber=function(a){return"[object Number]"==
k.call(a)};g.isFinite=function(a){return g.isNumber(a)&&isFinite(a)};g.isNaN=function(a){return a!==a};g.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};g.isDate=function(a){return"[object Date]"==k.call(a)};g.isRegExp=function(a){return"[object RegExp]"==k.call(a)};g.isNull=function(a){return null===a};g.isUndefined=function(a){return void 0===a};g.has=function(a,b){return m.call(a,b)};g.noConflict=function(){e._=a;return this};g.identity=function(a){return a};g.times=
function(a,b,c){for(var i=0;i<a;i++)b.call(c,i)};g.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};g.result=function(a,b){if(null==a)return null;var c=a[b];return g.isFunction(c)?c.call(a):c};g.mixin=function(a){w(g.functions(a),function(b){var c=g[b]=a[b];B.prototype[b]=function(){var a=h.call(arguments);j.call(a,this._wrapped);return E(c.apply(g,a),this._chain)}})};var i=0;g.uniqueId=
function(a){var b=i++;return a?a+b:b};g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/.^/,D={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},F;for(F in D)D[D[F]]=F;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,G=function(a){return a.replace(J,function(a,b){return D[b]})};g.template=function(a,b,c){c=g.defaults(c||{},g.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+D[a]}).replace(c.escape||
y,function(a,b){return"'+\n_.escape("+G(b)+")+\n'"}).replace(c.interpolate||y,function(a,b){return"'+\n("+G(b)+")+\n'"}).replace(c.evaluate||y,function(a,b){return"';\n"+G(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",i=new Function(c.variable||"obj","_",a);if(b)return i(b,g);b=function(a){return i.call(this,a,g)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
g.chain=function(a){return g(a).chain()};var B=function(a){this._wrapped=a};g.prototype=B.prototype;var E=function(a,b){return b?g(a).chain():a};g.mixin(g);w("pop push reverse shift sort splice unshift".split(" "),function(a){var b=d[a];B.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var i=c.length;("shift"==a||"splice"==a)&&0===i&&delete c[0];return E(c,this._chain)}});w(["concat","join","slice"],function(a){var b=d[a];B.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),
this._chain)}});B.prototype.chain=function(){this._chain=!0;return this};B.prototype.value=function(){return this._wrapped}}).call(this);
(function(){var b=this,e=b.Backbone,a=Array.prototype.slice,c=Array.prototype.splice,d;d="undefined"!==typeof exports?exports:b.Backbone={};d.VERSION="0.9.2";var f=b._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var h=b.jQuery||b.Zepto||b.ender;d.setDomLibrary=function(a){h=a};d.noConflict=function(){b.Backbone=e;return this};d.emulateHTTP=!1;d.emulateJSON=!1;var j=/\s+/,k=d.Events={on:function(a,b,c){var d,f,e,g,h;if(!b)return this;a=a.split(j);for(d=this._callbacks||(this._callbacks=
{});f=a.shift();)e=(h=d[f])?h.tail:{},e.next=g={},e.context=c,e.callback=b,d[f]={tail:g,next:h?h.next:e};return this},off:function(a,b,c){var d,e,g,h,l,q;if(e=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;for(a=a?a.split(j):f.keys(e);d=a.shift();)if(g=e[d],delete e[d],g&&(b||c))for(h=g.tail;(g=g.next)!==h;)if(l=g.callback,q=g.context,b&&l!==b||c&&q!==c)this.on(d,l,q);return this}},trigger:function(b){var c,d,f,e,g,h;if(!(f=this._callbacks))return this;g=f.all;b=b.split(j);for(h=
a.call(arguments,1);c=b.shift();){if(d=f[c])for(e=d.tail;(d=d.next)!==e;)d.callback.apply(d.context||this,h);if(d=g){e=d.tail;for(c=[c].concat(h);(d=d.next)!==e;)d.callback.apply(d.context||this,c)}}return this}};k.bind=k.on;k.unbind=k.off;var m=d.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=A(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(m.prototype,k,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=f.escape(null==
b?"":""+b)},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof m&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=c.changes={},g=this.attributes,h=this._escapedAttributes,l=this._previousAttributes||{};for(e in d){a=d[e];if(!f.isEqual(g[e],a)||c.unset&&f.has(g,e))delete h[e],(c.silent?this._silent:
b)[e]=!0;c.unset?delete g[e]:g[e]=a;!f.isEqual(l[e],a)||f.has(g,e)!=f.has(l,e)?(this.changed[e]=a,c.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}c.silent||this.change(c);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,f,e){if(!b.set(b.parse(d,e),a))return!1;c&&c(b,d)};
a.error=d.wrapError(a.error,b,a);return(this.sync||d.sync).call(this,"read",this,a)},save:function(a,b,c){var e,g;f.isObject(a)||null==a?(e=a,c=b):(e={},e[a]=b);c=c?f.clone(c):{};if(c.wait){if(!this._validate(e,c))return!1;g=f.clone(this.attributes)}a=f.extend({},c,{silent:!0});if(e&&!this.set(e,c.wait?a:c))return!1;var h=this,l=c.success;c.success=function(a,b,d){b=h.parse(a,d);c.wait&&(delete c.wait,b=f.extend(e||{},b));if(!h.set(b,c))return!1;l?l(h,a):h.trigger("sync",h,a,c)};c.error=d.wrapError(c.error,
h,c);b=this.isNew()?"create":"update";b=(this.sync||d.sync).call(this,b,this,c);c.wait&&this.set(g,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return e(),!1;a.success=function(d){a.wait&&e();c?c(b,d):b.trigger("sync",b,d,a)};a.error=d.wrapError(a.error,b,a);var g=(this.sync||d.sync).call(this,"delete",this,a);a.wait||e();return g},url:function(){var a=A(this,"urlRoot")||A(this.collection,"url")||C();
return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=f.extend({},a.changes,this._silent);this._silent={};for(c in d)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});var q=d.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(q.prototype,k,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var d,e,g,h,l,j={},q={},r=[];b||(b={});a=f.isArray(a)?a.slice():[a];d=0;for(e=a.length;d<e;d++){if(!(g=a[d]=this._prepareModel(a[d],b)))throw Error("Can't add an invalid model to a collection");h=g.cid;l=g.id;j[h]||this._byCid[h]||null!=l&&(q[l]||this._byId[l])?
r.push(d):j[h]=q[l]=g}for(d=r.length;d--;)a.splice(r[d],1);d=0;for(e=a.length;d<e;d++)(g=a[d]).on("all",this._onModelEvent,this),this._byCid[g.cid]=g,null!=g.id&&(this._byId[g.id]=g);this.length+=e;c.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;d=0;for(e=this.models.length;d<e;d++)if(j[(g=this.models[d]).cid])b.index=d,g.trigger("add",g,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?
a.slice():[a];c=0;for(d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},b));return a},
shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return f.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,
e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=d.wrapError(a.error,b,a);return(this.sync||d.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof m?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
arguments))}});f.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first initial rest last without indexOf shuffle lastIndexOf isEmpty groupBy".split(" "),function(a){q.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});var n=d.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},t=/:\w+/g,
r=/\*\w+/g,s=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(n.prototype,k,{initialize:function(){},route:function(a,b,c){d.history||(d.history=new u);f.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);d.history.route(a,f.bind(function(e){e=this._extractParameters(a,e);c&&c.apply(this,e);this.trigger.apply(this,["route:"+b].concat(e));d.history.trigger("route",this,b,e)},this));return this},navigate:function(a,b){d.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,
this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(s,"\\$&").replace(t,"([^/]+)").replace(r,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var u=d.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},p=/^[#\/]/,l=/msie [\w.]+/;u.started=!1;f.extend(u.prototype,k,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:
""},getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=this.getHash();a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(p,"")},start:function(a){if(u.started)throw Error("Backbone.history has already been started");u.started=!0;this.options=f.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=l.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?h(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?h(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&(this._hasPushState&&b&&a.hash)&&(this.fragment=this.getHash().replace(p,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);u.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,
function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!u.started)return!1;if(!b||!0===b)b={trigger:b};var c=(a||"").replace(p,"");this.fragment!=c&&(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.getHash(this.iframe))&&(b.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var x=d.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},v=/^(\S+)\s*(.*)$/,z="model collection el id attributes className tagName".split(" ");
f.extend(x.prototype,k,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&h(a).attr(b);c&&h(a).html(c);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof h?a:h(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=A(this,"events"))){this.undelegateEvents();
for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(v),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=z.length;b<c;b++){var d=z[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=A(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});m.extend=q.extend=n.extend=x.extend=function(a,b){var c=this,d;d=a&&a.hasOwnProperty("constructor")?a.constructor:function(){c.apply(this,arguments)};f.extend(d,c);w.prototype=c.prototype;d.prototype=new w;a&&f.extend(d.prototype,a);b&&f.extend(d,b);d.prototype.constructor=d;d.__super__=c.prototype;d.extend=this.extend;return d};var g={create:"POST",
update:"PUT","delete":"DELETE",read:"GET"};d.sync=function(a,b,c){var e=g[a];c||(c={});var l={type:e,dataType:"json"};c.url||(l.url=A(b,"url")||C());if(!c.data&&b&&("create"==a||"update"==a))l.contentType="application/json",l.data=JSON.stringify(b.toJSON());d.emulateJSON&&(l.contentType="application/x-www-form-urlencoded",l.data=l.data?{model:l.data}:{});if(d.emulateHTTP&&("PUT"===e||"DELETE"===e))d.emulateJSON&&(l.data._method=e),l.type="POST",l.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
e)};"GET"!==l.type&&!d.emulateJSON&&(l.processData=!1);return h.ajax(f.extend(l,c))};d.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var w=function(){},A=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},C=function(){throw Error('A "url" property or function must be specified');}}).call(this);
!function(b){b(function(){var e=b.support,a;a:{a=document.createElement("bootstrap");var c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},d;for(d in c)if(void 0!==a.style[d]){a=c[d];break a}a=void 0}e.transition=a&&{end:a}})}(window.jQuery);
!function(b){var e=function(a){b(a).on("click",'[data-dismiss="alert"]',this.close)};e.prototype.close=function(a){function c(){h.trigger("closed").remove()}var d=b(this),e=d.attr("data-target"),h;e||(e=(e=d.attr("href"))&&e.replace(/.*(?=#[^\s]*$)/,""));h=b(e);a&&a.preventDefault();h.length||(h=d.hasClass("alert")?d:d.parent());h.trigger(a=b.Event("close"));a.isDefaultPrevented()||(h.removeClass("in"),b.support.transition&&h.hasClass("fade")?h.on(b.support.transition.end,c):c())};b.fn.alert=function(a){return this.each(function(){var c=
b(this),d=c.data("alert");d||c.data("alert",d=new e(this));"string"==typeof a&&d[a].call(c)})};b.fn.alert.Constructor=e;b(function(){b("body").on("click.alert.data-api",'[data-dismiss="alert"]',e.prototype.close)})}(window.jQuery);
!function(b){var e=function(a,c){this.$element=b(a);this.options=b.extend({},b.fn.button.defaults,c)};e.prototype.setState=function(a){var b=this.$element,d=b.data(),e=b.is("input")?"val":"html",a=a+"Text";d.resetText||b.data("resetText",b[e]());b[e](d[a]||this.options[a]);setTimeout(function(){"loadingText"==a?b.addClass("disabled").attr("disabled","disabled"):b.removeClass("disabled").removeAttr("disabled")},0)};e.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons-radio"]');
a&&a.find(".active").removeClass("active");this.$element.toggleClass("active")};b.fn.button=function(a){return this.each(function(){var c=b(this),d=c.data("button"),f="object"==typeof a&&a;d||c.data("button",d=new e(this,f));"toggle"==a?d.toggle():a&&d.setState(a)})};b.fn.button.defaults={loadingText:"loading..."};b.fn.button.Constructor=e;b(function(){b("body").on("click.button.data-api","[data-toggle^=button]",function(a){a=b(a.target);a.hasClass("btn")||(a=a.closest(".btn"));a.button("toggle")})})}(window.jQuery);
!function(b){var e=function(a,c){this.$element=b(a);this.options=c;this.options.slide&&this.slide(this.options.slide);"hover"==this.options.pause&&this.$element.on("mouseenter",b.proxy(this.pause,this)).on("mouseleave",b.proxy(this.cycle,this))};e.prototype={cycle:function(a){a||(this.paused=!1);this.options.interval&&!this.paused&&(this.interval=setInterval(b.proxy(this.next,this),this.options.interval));return this},to:function(a){var c=this.$element.find(".item.active"),d=c.parent().children(),
c=d.index(c),e=this;if(!(a>d.length-1||0>a))return this.sliding?this.$element.one("slid",function(){e.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",b(d[a]))},pause:function(a){a||(this.paused=!0);this.$element.find(".next, .prev").length&&b.support.transition.end&&(this.$element.trigger(b.support.transition.end),this.cycle());clearInterval(this.interval);this.interval=null;return this},next:function(){if(!this.sliding)return this.slide("next")},prev:function(){if(!this.sliding)return this.slide("prev")},
slide:function(a,c){var d=this.$element.find(".item.active"),e=c||d[a](),h=this.interval,j="next"==a?"left":"right",k="next"==a?"first":"last",m=this,q=b.Event("slide",{relatedTarget:e[0]});this.sliding=!0;h&&this.pause();e=e.length?e:this.$element.find(".item")[k]();if(!e.hasClass("active")){if(b.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(q);if(q.isDefaultPrevented())return;e.addClass(a);e[0].offsetWidth;d.addClass(j);e.addClass(j);this.$element.one(b.support.transition.end,
function(){e.removeClass([a,j].join(" ")).addClass("active");d.removeClass(["active",j].join(" "));m.sliding=!1;setTimeout(function(){m.$element.trigger("slid")},0)})}else{this.$element.trigger(q);if(q.isDefaultPrevented())return;d.removeClass("active");e.addClass("active");this.sliding=!1;this.$element.trigger("slid")}h&&this.cycle();return this}}};b.fn.carousel=function(a){return this.each(function(){var c=b(this),d=c.data("carousel"),f=b.extend({},b.fn.carousel.defaults,"object"==typeof a&&a),
h="string"==typeof a?a:f.slide;d||c.data("carousel",d=new e(this,f));if("number"==typeof a)d.to(a);else if(h)d[h]();else f.interval&&d.cycle()})};b.fn.carousel.defaults={interval:5E3,pause:"hover"};b.fn.carousel.Constructor=e;b(function(){b("body").on("click.carousel.data-api","[data-slide]",function(a){var c=b(this),d,e=b(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),c=!e.data("modal")&&b.extend({},e.data(),c.data());e.carousel(c);a.preventDefault()})})}(window.jQuery);
!function(b){var e=function(a,c){this.$element=b(a);this.options=b.extend({},b.fn.collapse.defaults,c);this.options.parent&&(this.$parent=b(this.options.parent));this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){return this.$element.hasClass("width")?"width":"height"},show:function(){var a,c,d,e;if(!this.transitioning){a=this.dimension();c=b.camelCase(["scroll",a].join("-"));if((d=this.$parent&&this.$parent.find("> .accordion-group > .in"))&&d.length){if((e=d.data("collapse"))&&
e.transitioning)return;d.collapse("hide");e||d.data("collapse",null)}this.$element[a](0);this.transition("addClass",b.Event("show"),"shown");b.support.transition&&this.$element[a](this.$element[0][c])}},hide:function(){var a;this.transitioning||(a=this.dimension(),this.reset(this.$element[a]()),this.transition("removeClass",b.Event("hide"),"hidden"),this.$element[a](0))},reset:function(a){var b=this.dimension();this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth;this.$element[null!==
a?"addClass":"removeClass"]("collapse");return this},transition:function(a,c,d){var e=this,h=function(){"show"==c.type&&e.reset();e.transitioning=0;e.$element.trigger(d)};this.$element.trigger(c);c.isDefaultPrevented()||(this.transitioning=1,this.$element[a]("in"),b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,h):h())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};b.fn.collapse=function(a){return this.each(function(){var c=
b(this),d=c.data("collapse"),f="object"==typeof a&&a;d||c.data("collapse",d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.collapse.defaults={toggle:!0};b.fn.collapse.Constructor=e;b(function(){b("body").on("click.collapse.data-api","[data-toggle=collapse]",function(a){var c=b(this),d,a=c.attr("data-target")||a.preventDefault()||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"");d=b(a).data("collapse")?"toggle":c.data();c[b(a).hasClass("in")?"addClass":"removeClass"]("collapsed");b(a).collapse(d)})})}(window.jQuery);
!function(b){function e(){a(b(c)).removeClass("open")}function a(a){var c=a.attr("data-target");c||(c=(c=a.attr("href"))&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));c=b(c);c.length||(c=a.parent());return c}var c="[data-toggle=dropdown]",d=function(a){var c=b(a).on("click.dropdown.data-api",this.toggle);b("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};d.prototype={constructor:d,toggle:function(){var c=b(this),d,j;if(!c.is(".disabled, :disabled"))return d=a(c),j=
d.hasClass("open"),e(),j||(d.toggleClass("open"),c.focus()),!1},keydown:function(c){var d,e,k;if(/(38|40|27)/.test(c.keyCode)&&(d=b(this),c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled"))){e=a(d);k=e.hasClass("open");if(!k||k&&27==c.keyCode)return d.click();d=b("[role=menu] li:not(.divider) a",e);d.length&&(e=d.index(d.filter(":focus")),38==c.keyCode&&0<e&&e--,40==c.keyCode&&e<d.length-1&&e++,~e||(e=0),d.eq(e).focus())}}};b.fn.dropdown=function(a){return this.each(function(){var c=
b(this),e=c.data("dropdown");e||c.data("dropdown",e=new d(this));"string"==typeof a&&e[a].call(c)})};b.fn.dropdown.Constructor=d;b(function(){b("html").on("click.dropdown.data-api touchstart.dropdown.data-api",e);b("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",c,d.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",c+", [role=menu]",d.prototype.keydown)})}(window.jQuery);
!function(b){var e=function(a,c){this.options=c;this.$element=b(a).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};e.prototype={constructor:e,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var a=this,c=b.Event("show");this.$element.trigger(c);!this.isShown&&!c.isDefaultPrevented()&&(b("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var c=
b.support.transition&&a.$element.hasClass("fade");a.$element.parent().length||a.$element.appendTo(document.body);a.$element.show();c&&a.$element[0].offsetWidth;a.$element.addClass("in").attr("aria-hidden",!1).focus();a.enforceFocus();c?a.$element.one(b.support.transition.end,function(){a.$element.trigger("shown")}):a.$element.trigger("shown")}))},hide:function(a){a&&a.preventDefault();a=b.Event("hide");this.$element.trigger(a);this.isShown&&!a.isDefaultPrevented()&&(this.isShown=!1,b("body").removeClass("modal-open"),
this.escape(),b(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var a=this;b(document).on("focusin.modal",function(b){a.$element[0]!==b.target&&!a.$element.has(b.target).length&&a.$element.focus()})},escape:function(){var a=this;if(this.isShown&&this.options.keyboard)this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()});
else this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var a=this,c=setTimeout(function(){a.$element.off(b.support.transition.end);a.hideModal()},500);this.$element.one(b.support.transition.end,function(){clearTimeout(c);a.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(a){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&
this.options.backdrop){var d=b.support.transition&&c;this.$backdrop=b('<div class="modal-backdrop '+c+'" />').appendTo(document.body);"static"!=this.options.backdrop&&this.$backdrop.click(b.proxy(this.hide,this));d&&this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");d?this.$backdrop.one(b.support.transition.end,a):a()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),b.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(b.support.transition.end,b.proxy(this.removeBackdrop,
this)):this.removeBackdrop()):a&&a()}};b.fn.modal=function(a){return this.each(function(){var c=b(this),d=c.data("modal"),f=b.extend({},b.fn.modal.defaults,c.data(),"object"==typeof a&&a);d||c.data("modal",d=new e(this,f));if("string"==typeof a)d[a]();else f.show&&d.show()})};b.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0};b.fn.modal.Constructor=e;b(function(){b("body").on("click.modal.data-api",'[data-toggle="modal"]',function(a){var c=b(this),d=c.attr("href"),e=b(c.attr("data-target")||d&&
d.replace(/.*(?=#[^\s]+$)/,"")),d=e.data("modal")?"toggle":b.extend({remote:!/#/.test(d)&&d},e.data(),c.data());a.preventDefault();e.modal(d).one("hide",function(){c.focus()})})})}(window.jQuery);
!function(b){var e=function(a,b){this.init("tooltip",a,b)};e.prototype={constructor:e,init:function(a,c,d){this.type=a;this.$element=b(c);this.options=this.getOptions(d);this.enabled=!0;if("click"==this.options.trigger)this.$element.on("click."+this.type,this.options.selector,b.proxy(this.toggle,this));else"manual"!=this.options.trigger&&(a="hover"==this.options.trigger?"mouseenter":"focus",c="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(a+"."+this.type,this.options.selector,
b.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,b.proxy(this.leave,this)));this.options.selector?this._options=b.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(a){a=b.extend({},b.fn[this.type].defaults,a,this.$element.data());a.delay&&"number"==typeof a.delay&&(a.delay={show:a.delay,hide:a.delay});return a},enter:function(a){var c=b(a.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show)return c.show();
clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)},leave:function(a){var c=b(a.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!c.options.delay||!c.options.delay.hide)return c.hide();c.hoverState="out";this.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)},show:function(){var a,b,d,e,h,j,k;if(this.hasContent()&&this.enabled){a=this.tip();
this.setContent();this.options.animation&&a.addClass("fade");j="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement;b=/in/.test(j);a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body);d=this.getPosition(b);e=a[0].offsetWidth;h=a[0].offsetHeight;switch(b?j.split(" ")[1]:j){case "bottom":k={top:d.top+d.height,left:d.left+d.width/2-e/2};break;case "top":k={top:d.top-h,left:d.left+d.width/2-e/2};break;
case "left":k={top:d.top+d.height/2-h/2,left:d.left-e};break;case "right":k={top:d.top+d.height/2-h/2,left:d.left+d.width}}a.css(k).addClass(j).addClass("in")}},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b);a.removeClass("fade in top bottom left right")},hide:function(){var a=this.tip();a.removeClass("in");if(b.support.transition&&this.$tip.hasClass("fade")){var c=setTimeout(function(){a.off(b.support.transition.end).remove()},
500);a.one(b.support.transition.end,function(){clearTimeout(c);a.remove()})}else a.remove();return this},fixTitle:function(){var a=this.$element;if(a.attr("title")||"string"!=typeof a.attr("data-original-title"))a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(a){return b.extend({},a?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a=
this.$element,b=this.options;return a.attr("data-original-title")||("function"==typeof b.title?b.title.call(a[0]):b.title)},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+
this.type).removeData(this.type)}};b.fn.tooltip=function(a){return this.each(function(){var c=b(this),d=c.data("tooltip"),f="object"==typeof a&&a;d||c.data("tooltip",d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.tooltip.Constructor=e;b.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery);
!function(b){var e=function(a,b){this.init("popover",a,b)};e.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:e,setContent:function(){var a=this.tip(),b=this.getTitle(),d=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b);a.find(".popover-content > *")[this.options.html?"html":"text"](d);a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a=this.$element,b=this.options;
return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},tip:function(){this.$tip||(this.$tip=b(this.options.template));return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});b.fn.popover=function(a){return this.each(function(){var c=b(this),d=c.data("popover"),f="object"==typeof a&&a;d||c.data("popover",d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.popover.Constructor=e;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,
{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);
!function(b){function e(a,c){var d=b.proxy(this.process,this),e=b(a).is("body")?b(window):b(a),h;this.options=b.extend({},b.fn.scrollspy.defaults,c);this.$scrollElement=e.on("scroll.scroll-spy.data-api",d);this.selector=(this.options.target||(h=b(a).attr("href"))&&h.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a";this.$body=b("body");this.refresh();this.process()}e.prototype={constructor:e,refresh:function(){var a=this;this.offsets=b([]);this.targets=b([]);this.$body.find(this.selector).map(function(){var a=
b(this),a=a.data("target")||a.attr("href"),d=/^#\w/.test(a)&&b(a);return d&&d.length&&[[d.position().top,a]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){a.offsets.push(this[0]);a.targets.push(this[1])})},process:function(){var a=this.$scrollElement.scrollTop()+this.options.offset,b=(this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight)-this.$scrollElement.height(),d=this.offsets,e=this.targets,h=this.activeTarget,j;if(a>=b)return h!=(j=e.last()[0])&&this.activate(j);for(j=
d.length;j--;)h!=e[j]&&a>=d[j]&&(!d[j+1]||a<=d[j+1])&&this.activate(e[j])},activate:function(a){this.activeTarget=a;b(this.selector).parent(".active").removeClass("active");a=b(this.selector+'[data-target="'+a+'"],'+this.selector+'[href="'+a+'"]').parent("li").addClass("active");a.parent(".dropdown-menu").length&&(a=a.closest("li.dropdown").addClass("active"));a.trigger("activate")}};b.fn.scrollspy=function(a){return this.each(function(){var c=b(this),d=c.data("scrollspy"),f="object"==typeof a&&a;
d||c.data("scrollspy",d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.scrollspy.Constructor=e;b.fn.scrollspy.defaults={offset:10};b(window).on("load",function(){b('[data-spy="scroll"]').each(function(){var a=b(this);a.scrollspy(a.data())})})}(window.jQuery);
!function(b){var e=function(a){this.element=b(a)};e.prototype={constructor:e,show:function(){var a=this.element,c=a.closest("ul:not(.dropdown-menu)"),d=a.attr("data-target"),e,h;d||(d=(d=a.attr("href"))&&d.replace(/.*(?=#[^\s]*$)/,""));a.parent("li").hasClass("active")||(e=c.find(".active a").last()[0],h=b.Event("show",{relatedTarget:e}),a.trigger(h),h.isDefaultPrevented()||(d=b(d),this.activate(a.parent("li"),c),this.activate(d,d.parent(),function(){a.trigger({type:"shown",relatedTarget:e})})))},
activate:function(a,c,d){function e(){h.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");a.addClass("active");j?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade");a.parent(".dropdown-menu")&&a.closest("li.dropdown").addClass("active");d&&d()}var h=c.find("> .active"),j=d&&b.support.transition&&h.hasClass("fade");j?h.one(b.support.transition.end,e):e();h.removeClass("in")}};b.fn.tab=function(a){return this.each(function(){var c=b(this),d=c.data("tab");d||c.data("tab",
d=new e(this));if("string"==typeof a)d[a]()})};b.fn.tab.Constructor=e;b(function(){b("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(a){a.preventDefault();b(this).tab("show")})})}(window.jQuery);
!function(b){var e=function(a,c){this.$element=b(a);this.options=b.extend({},b.fn.typeahead.defaults,c);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=b(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=!1;this.listen()};e.prototype={constructor:e,select:function(){var a=this.$menu.find(".active").attr("data-value");
this.$element.val(this.updater(a)).change();return this.hide()},updater:function(a){return a},show:function(){var a=b.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:a.top+a.height,left:a.left});this.$menu.show();this.shown=!0;return this},hide:function(){this.$menu.hide();this.shown=!1;return this},lookup:function(){var a;this.query=this.$element.val();return!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(a=b.isFunction(this.source)?
this.source(this.query,b.proxy(this.process,this)):this.source)?this.process(a):this},process:function(a){var c=this,a=b.grep(a,function(a){return c.matcher(a)}),a=this.sorter(a);return!a.length?this.shown?this.hide():this:this.render(a.slice(0,this.options.items)).show()},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b=[],d=[],e=[],h;h=a.shift();)h.toLowerCase().indexOf(this.query.toLowerCase())?~h.indexOf(this.query)?d.push(h):e.push(h):
b.push(h);return b.concat(d,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(a){var c=this,a=b(a).map(function(a,e){a=b(c.options.item).attr("data-value",e);a.find("a").html(c.highlighter(e));return a[0]});a.first().addClass("active");this.$menu.html(a);return this},next:function(){var a=this.$menu.find(".active").removeClass("active").next();a.length||
(a=b(this.$menu.find("li")[0]));a.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active").prev();a.length||(a=this.$menu.find("li").last());a.addClass("active")},listen:function(){this.$element.on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this));if(b.browser.chrome||b.browser.webkit||b.browser.msie)this.$element.on("keydown",b.proxy(this.keydown,this));this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter",
"li",b.proxy(this.mouseenter,this))},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault();this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(a){this.suppressKeyPressRepeat=!~b.inArray(a.keyCode,[40,38,9,13,27]);this.move(a)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;
this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation();a.preventDefault()},blur:function(){var a=this;setTimeout(function(){a.hide()},150)},click:function(a){a.stopPropagation();a.preventDefault();this.select()},mouseenter:function(a){this.$menu.find(".active").removeClass("active");b(a.currentTarget).addClass("active")}};b.fn.typeahead=function(a){return this.each(function(){var c=b(this),d=c.data("typeahead"),f="object"==typeof a&&a;d||c.data("typeahead",
d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};b.fn.typeahead.Constructor=e;b(function(){b("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(a){var c=b(this);c.data("typeahead")||(a.preventDefault(),c.typeahead(c.data()))})})}(window.jQuery);
!function(b){var e=function(a,c){this.options=b.extend({},b.fn.affix.defaults,c);this.$window=b(window).on("scroll.affix.data-api",b.proxy(this.checkPosition,this));this.$element=b(a);this.checkPosition()};e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var a=b(document).height(),c=this.$window.scrollTop(),d=this.$element.offset(),e=this.options.offset,h=e.bottom,j=e.top;"object"!=typeof e&&(h=j=e);"function"==typeof j&&(j=e.top());"function"==typeof h&&(h=e.bottom());a=null!=
this.unpin&&c+this.unpin<=d.top?!1:null!=h&&d.top+this.$element.height()>=a-h?"bottom":null!=j&&c<=j?"top":!1;this.affixed!==a&&(this.affixed=a,this.unpin="bottom"==a?d.top-c:null,this.$element.removeClass("affix affix-top affix-bottom").addClass("affix"+(a?"-"+a:"")))}};b.fn.affix=function(a){return this.each(function(){var c=b(this),d=c.data("affix"),f="object"==typeof a&&a;d||c.data("affix",d=new e(this,f));if("string"==typeof a)d[a]()})};b.fn.affix.Constructor=e;b.fn.affix.defaults={offset:0};
b(window).on("load",function(){b('[data-spy="affix"]').each(function(){var a=b(this),c=a.data();c.offset=c.offset||{};c.offsetBottom&&(c.offset.bottom=c.offsetBottom);c.offsetTop&&(c.offset.top=c.offsetTop);a.affix(c)})})}(window.jQuery);
var App=function(){function b(){return this}function e(){return arguments.callee.caller.__owner__.__super__}function a(b){var c=Backbone.Model.extend.apply(this,arguments),d;for(d in b)$.isFunction(b[d])&&(b[d].__owner__=c);c.extend=a;return c}function c(a,b){if(b)for(var c in b)a.on(c,b[c])}function d(a,b,c){b.extend&&(a=t[c](b.extend),delete b.extend);return a}function f(a){function b(){clearTimeout(e)}function c(){a.isManualClose||(e=setTimeout(d,3E3))}function d(){m=null;b();f.fadeOut(200,function(){$(this).remove()});
return!1}var e,f=$(n(a)).appendTo($("body")),h=App.getView("Button"),j=a.buttons,q=f.find("._buttons"),r;m&&m.triggerHandler("close");if(j)for(var s=0;s<j.length;s++)"ok"==j[s]?r=new h({type:a.type,text:"OK",click:function(){d();a.callback&&a.callback()}}):"cancel"==j[s]&&(r=new h({text:"\u041e\u0442\u043c\u0435\u043d\u0430",click:function(){d()}})),r&&q.append(r.$el);else q.remove();m=f.css({opacity:0,"margin-top":-10,left:"50%","max-width":f.width(),"margin-left":-f.width()/2}).find(".close").click(d).end().animate({"margin-top":0,
opacity:1},200).on({close:d,mouseenter:b,mouseleave:c});a.modal&&(a.isManualClose=!0,f.click(function(a){a.stopPropagation()}),f=f.wrap('<div class="b-systemmsg-over">').parent().hide().fadeIn(200).click(d));c()}_.templateSettings={interpolate:/\{(.+?)\}/g};Backbone.sync=function(a,b,c){"create"==a&&(a="update");"update"==a&&b instanceof r&&(c.params=$.extend(b.attributes||{},c.params));"delete"==a&&b instanceof r&&(c.params={id:b.id});a=App.rpc.request(b.api+"."+a,c.params).on("success",c.success,
b).on("error",c.error,b).on("complete",c.complete,b);return b.__sync=a};var h={},j={},k={},m,q=!1,n=_.template('<div class="b-systemmsg"><div class="alert alert-{type} alert-block"><button type="button" class="close" data-dismiss="alert">\u00d7</button><h4 class="alert-heading">{title}</h4><p>{text}</p><p class="_buttons"></p></div></div>'),t={view:{getScrollbarWidth:function(){var a=arguments.callee;if(!a.width){var b=$('<div style="width:50px;height:50px;overflow:auto;position:absolute;top:-200px;left:-200px;">');
$("body").append(b);var c=b.innerWidth(),d=b.append('<div style="height:100px;width:100%;">').find("div").innerWidth();$(b).remove();a.width=c-d}return a.width},setLoading:function(a,b){if(a){if(b){a.addClass("state_loading");var c=$('<div class="b-loading"></div>').hide().appendTo(a).fadeIn(200);50>a.height()&&c.css({"border-radius":a.css("border-radius"),"background-color":a.css("background-color")}).addClass("mod_small")}else a.children(".b-loading").fadeOut(200,function(){$(this).remove();a.removeClass("state_loading")});
return this}},applyInset:function(a){q&&!a.is("._inset")&&a.addClass("effect-inset _inset").css({"background-color":a.css("color"),color:"transparent"});return a}},msg:{alert:function(a){f($.extend({type:"error"},a))},warning:function(a){f($.extend({type:"warning"},a))},success:function(a){f($.extend({type:"success"},a))},okcancel:function(a){f($.extend({type:"info",modal:!0,buttons:["ok","cancel"]},a))}},defineView:function(a,b){h[a]=d(s,b,"getView").extend(b)},getView:function(a){return h[a]},defineModel:function(a,
b){j[a]=d(r,b,"getModel").extend(b)},getModel:function(a){return j[a]},defineCollection:function(a,b){k[a]=d(u,b,"getCollection").extend(b)},getCollection:function(a){return k[a]},debounce:function(a,b,c,d){if(!d)return _.debounce.call(_,a,b,c);var e={},f=_.uniqueId("_debounce");return function(){var d=arguments[0]||"null";"string"==typeof d||$.isNumeric(d)?(e[d]||(e[d]=_.debounce.call(_,a,b,c)),d=e[d]):(d[f]||(d[f]=_.debounce.call(_,a,b,c)),d=d[f]);d.apply(this,arguments)}}},r=a.call(Backbone.Model,
{initialize:function(){c(this,this.listeners)},validate:function(a,b){if(this.validateModel){if(b.onlynew)for(var c in a)a[c]==this.attributes[c]&&delete a[c];return this.validateModel(a,b)}return!1},parse:function(a){return a&&a.model?a.model:a},parent:e}),s=a.call(Backbone.View,{initialize:function(a){a||(a={});c(this,a.listeners);this.cid=_.uniqueId();this.init();this.render();this.$el.data("component",this).attr("data-component",this.ctype||!0);this.trigger("init")},init:b,render:function(){this.doRender();
this.doPresenter();return this},doRender:b,doPresenter:b,hide:function(a){if(a)this.$el.hide();else return this.$el.is(":visible")?this.$el.fadeOut(200):this.$el.hide(),this},setLoading:function(a){t.view.setLoading(this.$el,a);return this},show:function(){if(this.$el.is(":visible"))return this;this.$el.fadeIn(200);this._isLayout||this.layout();return this},layout:function(){if(this._isLayout||this.$el.is(":hidden"))return this;this.doLayout();this._isLayout=!0;return this},doLayout:b,parent:e}),
u=a.call(Backbone.Collection,{initialize:function(a,b){c(this,this.listeners);b&&b.params&&(this.params=b.params);this._isLocal=b&&b.local&&!0;this.init();this.model&&(this.api=this.model.prototype.api);this._fetched=!this.api},init:b,getName:function(a){return a.get("name")},fetch:function(a){this._fetched=!0;a||(a={});a.params=$.extend({},this.params,a.params);return u.__super__.fetch.call(this,a)},get:function(a){return u.__super__.get.apply(this,arguments)||u.__super__.getByCid.apply(this,arguments)},
add:function(a){for(var b,c=0;c<a.length;c++)(b=this._byId[a[c].id])&&b.set(a[c]);this.parent().add.apply(this,arguments)},isLocal:function(){return this._isLocal},isFetched:function(){return this._fetched},parse:function(a){return a&&a.data?a.data:a},parent:e}),p=$('<div class="effect-inset"></div>').appendTo("body"),q="text"==p.css("background-clip");p.remove();return t}();
App.defineModel("ClassFieldSubtype",{defaults:{id:null,Value:""},changePosition:function(b,e){if(!this.id)return this;e||(e={});App.rpc.request(this.api+".position",{id:this.id,index:b}).on("success",e.success,this).on("error",e.error,this).on("complete",e.complete,this);return this},validateModel:function(b){var e=[],b=b.Value;"undefined"!=typeof b&&0==b.length&&e.push({name:"Value",msg:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"});
return 0<e.length?e:null},api:"classfieldsubtype"});App.defineCollection("ClassFieldSubtype",{model:App.getModel("ClassFieldSubtype")});
App.defineModel("ClassField",{defaults:{Name:"",Description:"",Type:0,Default:"",Required:!1,Unique:!1,External:!0},validateModel:function(b){var e=[],b=b.Name;"undefined"!=typeof b&&(4>b.length?e.push({name:"Name",msg:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 4 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):/^[a-z]+[a-z0-9]*$/i.test(b)||e.push({name:"Name",msg:"\u041d\u0435 \u0432\u0435\u0440\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044f"}));
return 0<e.length?e:null},getCollectionSubtypes:function(){return new (App.getCollection("ClassFieldSubtype"))(null,{params:{FieldId:this.id}})},api:"classfield"});$.extend(App.getModel("ClassField"),{fieldTypes:{"0":"Integer",1:"Bigint",2:"Smallint",3:"Numeric",4:"Boolean",5:"Timestamp",6:"Text",7:"Subtype"}});App.defineCollection("ClassField",{model:App.getModel("ClassField")});
App.defineModel("ClassFunctionField",{defaults:{id:null,Name:"",Info:"",Datatype:0,isConfigurable:!1,isNull:!1,isArray:0},validateModel:function(b){var e=[],a,c="_isArray"in b?b._isArray:this.attributes._isArray;a=b.Name;"undefined"!=typeof a&&(4>a.length?e.push({name:"Name",msg:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 4 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):/^[a-z]+[a-z0-9]*$/i.test(a)||e.push({name:"Name",msg:"\u041d\u0435 \u0432\u0435\u0440\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044f"}));
a=b._Array;"undefined"!=typeof a&&c&&(!/^\d{1}$/.test(a)||!(0<parseInt(a)&&5>parseInt(a)))&&e.push({name:"_Array",msg:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u043d\u043e\u0441\u0442\u044c 1-4"});return 0<e.length?e:null},api:"classfunctionfield"});$.extend(App.getModel("ClassFunctionField"),{fieldTypes:App.getModel("ClassField").fieldTypes});App.defineCollection("ClassFunctionField",{model:App.getModel("ClassFunctionField")});
App.defineModel("ClassFunction",{defaults:{Name:"",Info:"",Type:0,isActive:!1,UseFields:!1},getCollectionFields:function(b){return this.id?new (App.getCollection("ClassFunctionField"))(null,{params:{FunctionId:this.id,type:b}}):null},validateModel:function(b){var e=[],a;a=b.Name;"undefined"!=typeof a&&(4>a.length?e.push({name:"Name",msg:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 4 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):/^[a-z]+[a-z0-9]*$/i.test(a)||
e.push({name:"Name",msg:"\u041d\u0435 \u0432\u0435\u0440\u043d\u043e\u0435 \u043d\u0430\u0437\u043d\u0432\u0430\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438"}));a=b.Info;"undefined"!=typeof a&&0==a.length&&e.push({name:"Info",msg:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043a \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e"});return 0<e.length?e:null},api:"classfunction"});
$.extend(App.getModel("ClassFunction"),{functionTypes:{"0":"\u0427\u0442\u0435\u043d\u0438\u0435",1:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435",2:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435"}});App.defineCollection("ClassFunction",{model:App.getModel("ClassFunction")});
App.defineModel("Class",{defaults:{ClassName:"",ClassInfo:"",System:!1,AllWorkspace:!1,WorkspaceId:""},getCollectionFields:function(){return new (App.getCollection("ClassField"))(null,{local:!this.id,params:{ClassId:this.id}})},getCollectionFunctions:function(){return this.id?new (App.getCollection("ClassFunction"))(null,{params:{ClassId:this.id}}):null},validateModel:function(b){var e=[],a;a=b.ClassName;"undefined"!=typeof a&&(4>a.length?e.push({name:"ClassName",msg:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 4 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):
/^[a-z]+[a-z0-9]*$/i.test(a)||e.push({name:"ClassName",msg:"\u041d\u0435 \u0432\u0435\u0440\u043d\u043e\u0435 \u043d\u0430\u0437\u043d\u0432\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0430"}));a=b.ClassInfo;"undefined"!=typeof a&&0==a.length&&e.push({name:"ClassInfo",msg:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043a \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e"});return 0<e.length?e:null},api:"class"});$.extend(App.getModel("Class"),{getModelClassField:function(){return App.getModel("ClassField")}});
(function(b){function e(c,d){var e=this;this.request=$.ajax({url:(b.env.apiUrl||"")+"/api/"+c+(b.env.apiUrlSuffix||""),type:"post",data:JSON.stringify(d),dataType:"json",contentType:"application/json",success:function(b,c,d){b.success?e.trigger("success",b.data,c,d):(b.error&&a(b),e.trigger("error",b.data,c,d))},error:function(b,c,d){"abort"!=b.statusText&&(a(b),e.trigger("error",b,c,d))},complete:function(a,b,c){"abort"!=a.statusText&&e.trigger("complete",a,b,c)}})}function a(a){a="object"==typeof a.error?
a.error:{title:a.status+" "+a.statusText,msg:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430"};b.msg.alert({title:a.title,text:a.msg})}e.prototype=_.extend({abort:function(){this.request.abort();return this}},Backbone.Events);b.rpc={request:function(a,b){return new e(a,b)}}})(App);
(function(){function b(b){return b.replace(/[\/][^\/]+$/,"").replace(/^$/,"/")}App.defineCollection("CollectionNested",{init:function(){this._byPath={};this._fetchedNodes={};this._children={}},rootPath:"/",getPath:function(b){return b.get("path")},pathToArray:function(b){var a=this,c=[];b&&$.each(b.split("/"),function(){if(""!=this){var b=c[c.length-1],b=b?b+"/":a.rootPath;c.push(b+this)}});return c},getParent:function(e){return b(e)},getNode:function(b){return this._byPath[b]},isLeaf:function(b){return this._byPath[b]?
this._byPath[b].get("leaf"):!1},isFetched:function(b){return this._fetchedNodes[b]&&!0},getChildren:function(b){return this._children[b]||[]},fetchNode:function(b,a){var c=this,d=a.success;delete this._children[b];this.fetch($.extend(a,{add:!0,params:{path:b?b:this.rootPath},success:function(a){c._fetchedNodes[b]=!0;d&&d.apply(this,arguments)}},!0))},add:function(e,a){var c,d;resp=this.parent().add.call(this,e,$.extend({},a,{silent:!0}));for(var f=0;f<e.length;f++)d=this.get(e[f].id),c=d.get("path"),
this._byPath[c]=d,c=b(c),this._children[c]=this._children[c]||[],this._children[c].push(d);if(!a.silent)for(f=0;f<e.length;f++)d=this.get(e[f].id),d.trigger("add",d,this,a);return resp},remove:function(e){for(var a,c,d,f=0;f<e.length;f++)d=e[f],a=d.get("path"),c=b(a),delete this._byPath[a],this._children[c]=_.reject(this._children[c],function(a){return a.id==d.id});return this.parent().remove.apply(this,arguments)}})})();
App.defineCollection("Class",{model:App.getModel("Class"),extend:"CollectionNested",getName:function(b){return b.get("ClassName")}});
App.defineView("Container",{tagName:"div",className:"",ctype:"container",options:{fluid:!0},init:function(){this.$el.addClass("container"+(this.options.fluid?"-fluid":""))},doRender:function(){this._items=this.$el;return this},doLayout:function(){this.parent().doLayout.apply(this,arguments);this._items.find(">[data-component]").each(function(){$(this).data("component").layout()});return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},add:function(b){this._items.append(b.$el||
b);this.$el.is(":visible")&&b.layout&&b.layout();return this}});
(function(b){b.defineView("Popup",{options:{title:"",popupWidth:300},init:function(){},doRender:function(){var a=this;this._container=new (b.getView("Container"));this._container.$el.addClass("b-popup-body");this.$el=$(e({cid:this.cid,title:this.options.title})).on("click",function(){a.close()}).on("click","._popup"+this.cid,function(a){a.stopPropagation()}).on("click","._close"+this.cid,function(){a.close()}).find("._body"+this.cid).append(this._container.$el).end();this._titleEl=this.$el.find("._title"+
this.cid);this._footerEl=this.$el.find("._footer"+this.cid).remove();this._popupEl=this.$el.find("._popup"+this.cid);this._windowListeners={keydown:function(b){if(27==b.keyCode)return a.close(),!1}};return this},open:function(){if(this._isOpen)return this;this._isOpen=!0;$("body").append(this.$el);var a=$("html"),b=a.width();a.addClass("noscroll").css({marginRight:a.width()-b});this.$el.hide().fadeIn(300);this._popupEl.width(Math.min($(window).width()-30,this.options.popupWidth));$(window).on(this._windowListeners);
this.trigger("open");return this},close:function(){if(!this._isOpen)return this;this._isOpen=!1;this.$el.fadeOut(300,function(){$(this).detach();0==$(".b-popup").size()&&$("html").removeClass("noscroll").css({marginRight:0})});$(window).off(this._windowListeners);this.trigger("close");return this},setTitle:function(a){this._titleEl.html(a);return this},addButton:function(a){0==this.$el.has(this._footerEl).length&&this._footerEl.insertAfter(this.$el.find("._body"+this.cid));this._footerEl.append(a.$el||
a);return this},add:function(){this._container.add.apply(this._container,arguments);return this}});var e=_.template('<div class="b-popup"><div class="b-popup-h"><div class="b-popup-hh"><div class="modal _popup{cid}"><div class="modal-header"><button type="button" class="close _close{cid}">\u00d7</button><h3 class="_title{cid}">{title}</h3></div><div class="modal-body _body{cid}"></div><div class="modal-footer _footer{cid}"></div></div></div></div></div>')})(App);
App.defineView("Button",{tagName:"a",className:"btn",attributes:{href:"javascript:void(0)"},options:{icon:null,text:null,size:null,type:null,tooltip:null,disabled:null},init:function(){var b=this;if(this.options.click)this.on("click",this.options.click);this.$el.on("click",function(){$(this).is(".disabled")?b.trigger("disableclick"):b.trigger("click")})},doRender:function(){this.options.size&&this.$el.addClass("btn-"+this.options.size);this.options.icon&&this.$el.append('<i class="'+this.options.icon+
'"></i>');this.options.text&&this.$el.append(this.options.text);this.options.type&&this.$el.addClass("btn-"+this.options.type);this.options.menu&&(this.$el.addClass("dropdown-toggle").append('&nbsp;<span class="caret"></span>'),this.options.menu.setTarget(this));this.options.tooltip&&new (App.getView("Tooltip"))({target:this.$el,text:this.options.tooltip,position:"bottom"});this.options.disabled&&this.disable();return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},enable:function(){this.$el.removeClass("disabled");
return this},disable:function(){this.$el.addClass("disabled");return this},setText:function(b){this.$el.text(b||"")}});
(function(){function b(b){var d=this,f;this.model=b;this._model=this.model.clone();this._inBind=!0;for(var h in b.attributes)if(f=this._fields[h])f.setValue(b.attributes[h]),f.clearError();this._model.on("error",function(a,b){d.applyErrors(b)});this._model.set(b.attributes);this.model.on("change",function(){var b=this.model.changedAttributes(),c,d=this._model.set(b),f;for(f in b)(c=this.getField(f))&&c.setValue(b[f]),d&&(delete this._errors[f],c&&c.clearError());e.call(this);a.call(this)},this);this._inBind=
!1;a.call(this)}function e(){var a=!$.isEmptyObject(this._errors);this._isError!==a&&(this._isError=a,this.trigger("errorchange"))}function a(){if(this.model){var a=!1,b;for(b in this._fields)if("id"!=b&&!_.isEqual(this._fields[b].getValue(),this.model.attributes[b])){a=!0;break}this._isDirty!==a&&(this._isDirty=a,this.trigger("dirtychange"))}}App.defineView("Form",{tagName:"form",className:"b-form form-horizontal",tpl:_.template('<div class="_fields{cid}"></div><div class="control-group"><div class="b-form-buttons controls _buttons{cid}"></div></div>'),
options:{legend:null,model:null},legendTpl:_.template("<legend>{text}</legend>"),init:function(){this._fields={};this._errors={};this.on("dirtychange errorchange aftersave",function(){this._buttonSave&&(this._isDirty&&!this._isError?this._buttonSave.enable():this._buttonSave.disable());this._buttonCancel&&(this._isDirty?this._buttonCancel.show():this._buttonCancel.hide())})},doRender:function(){var b=this;this.$el.append($(this.tpl({cid:this.cid})));this.options.legend&&this.setLegend(this.options.legend);
this._fieldsEl=this.$el.find("._fields"+this.cid);this._buttonsEl=this.$el.find("._buttons"+this.cid);this._buttonSave=new (App.getView("Button"))({text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",type:"primary",listeners:{click:function(){b.save()},disableclick:function(){b.validate()}}});this._buttonCancel=new (App.getView("Button"))({text:"\u041e\u0442\u043c\u0435\u043d\u0430",listeners:{click:function(){b.cancel()}}});this.addButton(this._buttonSave);this.addButton(this._buttonCancel);
a.call(this);return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0,this.on("remove",function(){this.model&&this.model.off(null,null,this)}),this.model&&b.call(this,this.model))},askIfDirty:function(a,b){if(this._isDirty){var e=this;App.msg.okcancel({type:"warning",title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f",text:"\u0424\u043e\u0440\u043c\u0430 \u0438\u043c\u0435\u0435\u0442 \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435.",
callback:function(){e.cancel();a.call(b||e)}})}else a.call(b||this)},setModel:function(a){this._errors={};this.model&&this.model.off(null,null,this);b.call(this,a);return this},applyErrors:function(a){if(a){for(var b,f=0;f<a.length;f++)this._errors[a[f].name]=a[f],(b=this.getField(a[f].name))&&b.applyError(a[f].msg);e.call(this)}},validate:function(){if(!this._model)return this;this._model.set(this._model);return this},getModel:function(){return this.model},setLocal:function(a){this._isLocal=a;return this},
save:function(){var a=this,d=this._buttonSave,e=this.model.isNew(),h=this.model.changedAttributes(this._model.attributes),j={};this.trigger("beforesave",j,e,h);if(j.cancel)return this;if(this._isLocal)return this.model.set(h),b.call(this,this.getModel()),this.trigger("save",e),this;this.model.save(h,{wait:!0,success:function(){b.call(a,a.getModel());a.trigger("save",e)},error:function(b,d){d&&a.applyErrors(d.errors);a.trigger("error",e)},complete:function(){d.setLoading(!1);a.trigger("aftersave")}})&&
d.disable().setLoading(!0);return this},cancel:function(){b.call(this,this.model);return this},getField:function(a){return this._fields[a]},setLegend:function(a){this._legendEl?this._legendEl.html(a):(this._legendEl=$(this.legendTpl({text:a})),this.$el.prepend(this._legendEl));return this},add:function(b){var d=this,f;0==this.$el.has(b.$el).length&&this._fieldsEl.append(b.$el);b.$el.is("[data-form-field]")?(f=b.getName(),this._fields[f]=b,this.model&&b.setValue(this.model.get(f)),b.on("change",function(){d._inBind||
(this.model&&(this._model.set(f,b.getValue(),{onlynew:!0})&&(delete this._errors[f],b.clearError(),e.call(this)),a.call(this)),this.trigger("change:"+f,this))},this)):b.$el.find("[data-form-field]").each(function(){d.add($(this).data("field"))});return this},addButton:function(a){this._buttonsEl.append(a.$el);return this}})})();
App.defineView("Tooltip",{options:{text:"",target:null,position:"top",type:null,trigger:"hover"},init:function(){this._tooltip=$(this.options.target).tooltip({placement:this.options.position,trigger:this.options.trigger,title:this.options.text}).data("tooltip");this.options.type&&this._tooltip.tip().addClass("mod_"+this.options.type)},doRender:function(){this._items=this.$el.find("._items"+this.cid);return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},setText:function(b){if(this._tooltip.options.title==
b)return this;this._tooltip.options.title=b;this._tooltip.tip().is(":visible")&&this._tooltip.tip().find(".tooltip-inner").html(b);return this},hide:function(){this._tooltip.hide();return this},destroy:function(){this._tooltip.destroy();return this},show:function(){if(this._tooltip.tip().is(":visible"))return this;this._tooltip.show();return this}});
App.defineView("Field",{tagName:"div",className:"control-group",options:{label:""},tpl:_.template('<label class="b-field control-label _label{cid}" for="{name}{cid}">{label}</label><div class="controls"><div class="b-field-item _item{cid}"></div></div>'),tplHiddenLabel:_.template('<div><div class="b-field-item _item{cid}"></div></div>'),init:function(){this._name=this.options.name},doRender:function(){this.$el.append($((this.options.hideLabel?this.tplHiddenLabel:this.tpl)({cid:this.cid,name:this._name,
label:this.options.label})));this._name&&this.$el.attr("data-form-field",this._name).data("field",this);this._itemEl=this.$el.find("._item"+this.cid);return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0);return this},getName:function(){return this._name},getValue:function(){return this._value},setValue:function(b,e){if(b===this._value)return this;this._value=b;e||this.trigger("change");return this},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},
applyError:function(b){this.$el.addClass("error");this._error||(this._error=new (App.getView("Tooltip"))({target:this._itemEl,position:"bottom",type:"important",trigger:"hover"}));this._error.setText(b);this._itemEl.is(":hover")&&this._error.show()},clearError:function(){this._error&&(this._error.destroy(),delete this._error);this.$el.removeClass("error")}});
App.defineView("FieldTextarea",{extend:"Field",options:{label:"",name:null},itemTpl:_.template('<textarea id="{name}{cid}" rows="3" name="{name}"></textarea>'),init:function(){this.parent().init.call(this)},doRender:function(){this.parent().doRender.call(this);var b=this;this._itemEl.append(this.itemTpl({cid:this.cid,name:this.options.name}));this.$el.find("textarea").on("input paste keyup propertychange",function(){b.setValue($(this).val())});this.on("change",function(){this.$el.find("textarea").val(this._value)});
return this},doPresenter:function(){this.parent().doPresenter.call(this);return this}});
App.defineView("FieldText",{extend:"Field",options:{label:"",readonly:!1,name:null},itemTpl:_.template('<input id="{name}{cid}" name="{name}" value="{value}" type="text"/>'),itemReadOnlyTpl:_.template('<span class="input uneditable-input _input{cid}">{value}</span>'),init:function(){this.parent().init.call(this)},doRender:function(){this.parent().doRender.call(this);this.setReadOnly(this.options.readonly);this.on("change",function(){this._isReadOnly?this.$el.find("._input"+this.cid).text(this._value):
this.$el.find('input[type="text"]').val(this._value)});return this},doPresenter:function(){this.parent().doPresenter.call(this);return this},setReadOnly:function(b){if(this._isReadOnly!==b){var e=this;this._isReadOnly=b;this._itemEl.children().remove().end().append((!b?this.itemTpl:this.itemReadOnlyTpl)({cid:this.cid,name:this.options.name,value:this._value||""}));this.options.width&&this._itemEl.children().width(this.options.width);this.$el.find('input[type="text"]').on("input paste keyup propertychange",
function(){e.setValue($(this).val())})}}});
App.defineView("FieldSelect",{extend:"Field",options:{label:"",options:null,name:null,details:null},itemTpl:_.template('<select id="{name}{cid}" name="{name}"></select>'),init:function(){this.parent().init.call(this)},doRender:function(){this.parent().doRender.call(this);var b=this,e=this.options.options,a="";e["null"]&&(a+='<option value="">'+e["null"]+"</option>");if(e)for(var c in e)"null"!==c&&(a+='<option value="'+c+'">'+e[c]+"</option>");this._itemEl.append(this.itemTpl({cid:this.cid,name:this.options.name}));
this._selectEl=this.$el.find("select");this.setReadOnly(this.options.readonly);this._selectEl.append(a).on("change",function(){b.setValue($(this).val())});this.options.details&&(this._selectEl.width(175),e=this._selectEl.parent(),e.append($("<span>&nbsp;</span>")),e.append(this.options.details.$el));this.on("change",function(){this._selectEl.val(this._value+"")});return this},doPresenter:function(){this.parent().doPresenter.call(this);return this},setReadOnly:function(b){this._isReadOnly!==b&&((this._isReadOnly=
b)?this._selectEl.attr("disabled",!0):this._selectEl.removeAttr("disabled"))}});
App.defineView("FieldCheckbox",{extend:"Field",options:{label:"",readonly:!1,name:null},itemTpl:_.template('<input type="checkbox" id="{name}{cid}" name="{name}"/>'),init:function(){this.parent().init.call(this)},doRender:function(){this.parent().doRender.call(this);var b=this;this._itemEl.append(this.itemTpl({cid:this.cid,name:this.options.name}));this._inputEl=this.$el.find("input").on("click",function(){b.setValue($(this).is(":checked"))});this.setReadOnly(this.options.readonly);this.on("change",
function(){var b=this.$el.find("input");this._value?b.attr("checked",!0):b.removeAttr("checked")});return this},setReadOnly:function(b){this._isReadOnly!==b&&((this._isReadOnly=b)?this._inputEl.attr("disabled",!0):this._inputEl.removeAttr("disabled"))},doPresenter:function(){this.parent().doPresenter.call(this);return this}});
(function(){App.defineView("EditClassFunctionPopup",{extend:"Popup",options:{popupWidth:500},init:function(){this.parent().init.apply(this,arguments)},doRender:function(){this.parent().doRender.apply(this,arguments);var b=this,e=App.getView("Form"),a=App.getView("FieldTextarea"),c=App.getView("FieldText"),d=App.getView("FieldSelect"),f=App.getView("FieldCheckbox");App.getView("Button");var h=new c({label:"ID",readonly:!0,name:"id"}),c=new c({label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",
name:"Name"}),a=new a({label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",name:"Info"}),d=new d({width:175,label:"\u0422\u0438\u043f",name:"Type",options:App.getModel("ClassFunction").functionTypes}),j=new f({label:"\u0410\u043a\u0442\u0438\u0432\u043d\u0430\u044f",name:"isActive"}),f=new f({label:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044f \u043a\u043b\u0430\u0441\u0441\u0430",name:"UseFields"}),e=(new e({listeners:{save:function(a){var c=
this.getModel();b.trigger("save",a,c)}}})).add(c).add(a).add(d).add(j).add(f).add(h);h.hide();this.add(e);this._form=e;this._fieldName=c;this._fieldInfo=a;this._fieldType=d;this._fieldIsActive=j;this._fieldUseFields=f;this.setModel(this.model);return this},setModel:function(b){if(b)return this.setTitle(b.id?"\u0424\u0443\u043d\u043a\u0446\u0438\u044f "+(b.get("Name")||""):"\u041d\u043e\u0432\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f"),this.model=b,this._form.setModel(b),this},close:function(){var b=
this,e=this.parent().close;this._form.askIfDirty(function(){e.apply(b,arguments)});return b}})})();App.defineView("ContainerRow",{tagName:"div",className:"",options:{fluid:!0},init:function(){this.$el.addClass("row"+(this.options.fluid?"-fluid":""))},doRender:function(){this._items=this.$el;return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},add:function(b,e,a){b.$el.addClass("span"+e+(a?" offset"+a:""));this._items.append(b.$el);return this}});
(function(){function b(b,a){var c=b.getValue();c?a.show():a.hide();a.setValue(c?1:"").trigger("change")}App.defineView("EditClassFunctionFieldPopup",{extend:"Popup",options:{popupWidth:500},init:function(){this.parent().init.apply(this,arguments)},doRender:function(){this.parent().doRender.apply(this,arguments);var e=this,a=App.getView("Form"),c=App.getView("FieldTextarea"),d=App.getView("FieldText"),f=App.getView("FieldSelect"),h=App.getView("FieldCheckbox"),j=App.getView("ContainerRow");App.getView("Button");
var k=new d({label:"ID",readonly:!0,name:"id"}),m=new h({label:"\u041d\u0430\u0441\u0442\u0440\u0430\u0435\u0432\u0430\u0435\u043c\u043e\u0435 \u043f\u043e\u043b\u0435",name:"isConfigurable"}),q=new d({label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"Name"}),c=new c({label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",name:"Info"}),f=new f({width:175,label:"\u0422\u0438\u043f",name:"Datatype",options:App.getModel("ClassFunctionField").fieldTypes}),n=new h({label:"\u0417\u0430\u043f\u0440\u0435\u0442 null",
name:"isNull"}),t=new h({label:"\u041c\u0430\u0441\u0438\u0432",name:"_isArray"}),r=new d({width:20,name:"_Array",hideLabel:!0}),d=(new j({})).add(t,6).add(r,5),a=(new a({listeners:{beforesave:function(a,b,c){c.isArray=parseInt(c._Array)||0},save:function(a){var b=this.getModel();e.trigger("save",a,b)}}})).add(m).add(q).add(c).add(f).add(n).add(d).add(k);k.hide();this.add(a);t.on("change",function(){b.call(this,t,r)});b.call(this,t,r);this._form=a;this._fieldIsConfigurable=m;this._fieldName=q;this._fieldInfo=
c;this._fieldType=f;this._fieldIsNull=n;this._fieldArray=r;this.setModel(this.model);return this},setModel:function(b){if(b)return this.setTitle(b.id?"\u041f\u043e\u043b\u0435 "+(b.get("Name")||""):"\u041d\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435"),b=b||new ModelClassField({}),b.set({_isArray:0<b.get("isArray"),_Array:b.get("isArray")||null},{onlynew:!0}),this.model=b,this._form.setModel(b),this},close:function(){var b=this,a=this.parent().close;this._form.askIfDirty(function(){a.apply(b,
arguments)});return b}})})();
App.defineView("Toolbar",{tagName:"div",className:"btn-toolbar",groupTpl:_.template('<div class="btn-group"></div>'),init:function(){},doRender:function(){this._groupsEl=this.$el;return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},add:function(b,e){e||(e=0);var a=this._groupsEl.find(">[data-index="+e+"]");0==a.length&&(a=$(this.groupTpl()).attr("data-index",e),this._groupsEl.children().each(function(){if($(this).data("index")>e)return a.insertBefore($(this)),!1}),0==
this._groupsEl.has(a).length&&this._groupsEl.append(a));a.append(b.$el);return this}});
App.defineView("ToolbarHover",{extend:"Toolbar",hoverTpl:_.template('<div class="b-toolbarhover effect-autohide"><div class="b-toolbarhover-h _toolbar{cid}"></div></div>'),init:function(){},doRender:function(){this.parent().doRender.apply(this,arguments);var b=$(this.hoverTpl({cid:this.cid}));this._toolbar=b.find("._toolbar"+this.cid).append(this.$el);this.$el=b;return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0);this.parent().doPresenter.apply(this,arguments);return this},
setPanel:function(b){this.$el.appendTo(b.$el||b);return this}});
(function(b){function e(){if(this.collection){var a=this;this.collection.on("reset",function(){},this).on("add",function(b,c,d){f.call(a,b,d.index)},this).on("remove",function(b){j.call(a,b)},this)}}function a(){this._length=0;var a=this._bodyHEl.scrollTop(),b=this._bodyHEl.scrollLeft();this._bodyEl.children().remove();for(var d=this.collection.models,e=0;e<d.length;e++)f.call(this,d[e],e);c.call(this);this._bodyEl.fadeIn(200);this._bodyHEl.scrollTop(a).scrollLeft(b)}function c(){var a=0==this._length;
a!==this._isEmpty&&((this._isEmpty=a)?(this._emptyEl.fadeIn(200),this._bodyEl.hide(),b.view.applyInset(this._emptyEl)):(this._emptyEl.hide(),this._bodyEl.fadeIn(200)))}function d(a,b){var c=this._bodyEl.find('[data-id="'+(a.id||a.cid)+'"]'),d=this._bodyEl.find(">:eq("+b+")");0<d.length?c.insertBefore(d):c.appendTo(this._bodyEl)}function f(a,b){var d=this,e,f;e=h.call(this,a);this._length>b&&(f=this._bodyEl.find(">:eq("+b+")"));f&&0<f.length?e.insertBefore(f):e.appendTo(this._bodyEl);a.off("change",
null,this);a.on("change",function(){var b=h.call(d,a);e.replaceWith(b);e=b},this);this._length++;c.call(this)}function h(a){for(var b="",c,d=0;d<this._columns.length;d++)c=a.get(this._columns[d].key),this._columns[d].render&&(c=this._columns[d].render.call(this,c)),"boolean"==typeof c&&(c=c?'<i class="icon-ok"></i>':""),b+=t({cid:this.cid,text:c,align:this._columns[d].align||"left"});b=$(n({cid:this.cid,id:a.id||a.cid,items:b}));this._selectedRow==(a.id||a.cid)&&b.addClass("state_active");return b}
function j(a){var b=this._bodyEl.find('>[data-id="'+(a.id||a.cid)+'"]');0!=b.length&&(b.is(":visible")?b.fadeOut(200,function(){$(this).remove()}):b.remove(),this._length--,(a.id||a.cid)==this._selectedRow&&this.select(),c.call(this))}b.defineView("Grid",{options:{maxHeight:222,collection:null,collumns:null,selectable:!1,minColumnWidth:50,emptyText:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445",autoFetch:!1},init:function(){this._length=0;this._columns=[]},doRender:function(){var a=this;
this.$el=$(m({cid:this.cid,emptytext:this.options.emptyText}));this._colsEl=this.$el.find("._cols"+this.cid);this._headEl=this.$el.find("._head"+this.cid);this._headHEl=this.$el.find("._head-h"+this.cid);this._bodyEl=this.$el.find("._body"+this.cid).on("click","._row"+this.cid,function(){a.select($(this).data("id"))});this._bodyHEl=this.$el.find("._body-h"+this.cid).css("max-height",this.options.maxHeight).scroll(function(){a._headHEl.scrollLeft($(this).scrollLeft())});this._emptyEl=this.$el.find("._empty"+
this.cid);this._refreshButton=new (b.getView("Button"))({icon:"icon-refresh",type:"small",tooltip:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",click:function(){a.fetch()}});this._toolbar=new (b.getView("ToolbarHover"));this._toolbar.add(this._refreshButton,10).setPanel(this);this.options.reorderable&&(this._upButton=new (b.getView("Button"))({disabled:!0,icon:"icon-arrow-up",type:"small",tooltip:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u0432\u0435\u0440\u0445",
click:function(){var b=a._bodyEl.children().index(a._bodyEl.find('>[data-id="'+a._selectedRow+'"]'));if(0!=b){var c=a.collection.get(a._selectedRow);d.call(a,c,b-1);k.call(a,c,b-1)}}}),this._downButton=new (b.getView("Button"))({disabled:!0,icon:"icon-arrow-down",tooltip:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u043d\u0438\u0437",type:"small",click:function(){var b=a._bodyEl.children().index(a._bodyEl.find('>[data-id="'+a._selectedRow+'"]'));if(b!=a._length-1){var c=
a.collection.get(a._selectedRow);d.call(a,c,b+2);k.call(a,c,b+1)}}}),this._toolbar.add(this._upButton,9).add(this._downButton,9),this.on("selectionchange",function(a){a?(this._upButton.enable(),this._downButton.enable()):(this._upButton.disable(),this._downButton.disable())}));this.$el.on("mouseenter","._hover"+this.cid,function(){var c=$(this);c.data("tooltip")||(a._hoverAction=setTimeout(function(){c.css("position","absolute");var a=c.width();c.css("position","static");c.width()<a&&(a=c.data("tooltip"),
a||(a=new (b.getView("Tooltip"))({delay:{show:300},target:c,position:"top"}),c.data("tooltip",a)),a.setText(c.text()).show())},500))});this.$el.on("mouseleave","._hover"+this.cid,function(){clearTimeout(a._hoverAction)});var c=this.options.columns,e;this._columns=this._columns.concat(c);for(var f=0;f<c.length;f++)c[f].width=c[f].width||1,e=q({cid:this.cid,text:c[f].name,align:c[f].align||"left"}),this._colsEl.last().append('<col class="_col'+this.cid+'"/>'),this._headEl.append(e);this.setCollection(this.collection);
return this},doPresenter:function(){this._presenterOnce||(this.on("remove",function(){this.collection&&this.collection.off(null,null,this)}),this._presenterOnce=!0);e.call(this)},doLayout:function(){for(var a=this._columns,c,d,e=b.view.getScrollbarWidth(),f=this.$el.width()-e,h=0,j=d=0;j<a.length;j++)c=a[j].width,10<c?(this._colsEl.find("._col"+this.cid+":eq("+j+")").css("width",c+"px"),d+=c):h+=c;d=f-d;for(j=0;j<a.length;j++)c=a[j].width,10>=c&&(c=Math.max(this.options.minColumnWidth,parseInt(d*
(c/h))),this._colsEl.find("._col"+this.cid+":eq("+j+")").css("width",c+"px"));this._headHEl.css("margin-right",e+"px");this._bodyHEl.find("table").width(f)},layout:function(){this.parent().layout.apply(this,arguments);this.collection&&!this.collection.isFetched()&&this.fetch();return this},getToolbar:function(){return this._toolbar},select:function(a){var b=this._selectedRow;if(this._selectedRow!==a)return this._selectedRow=a,this._bodyEl.find(">.state_active").removeClass("state_active").end().find('>[data-id="'+
a+'"]').addClass("state_active").end(),this.trigger("selectionchange",a,b),this},getSelection:function(){return this._selectedRow?[this._selectedRow]:[]},setCollection:function(b){var c=this;this.collection&&this.collection.off(null,null,this);this.collection=b;e.call(this);this.select();!b||b.isLocal()?this._refreshButton.disable():this._refreshButton.enable();setTimeout(function(){c.collection&&(c.collection.isFetched()||c.collection.isLocal()?a.call(c):c.$el.is(":visible")&&c.fetch())},0);return this},
fetch:function(){if(this.collection){var c=this;b.view.setLoading(c.$el,!0);this.collection.fetch({silent:!0,success:function(){a.call(c)},complete:function(){b.view.setLoading(c.$el,!1)}})}}});var k=b.debounce(function(a,b){this.trigger("moverow",a.id,b)},1E3,!1,!0),m=_.template('<div class="b-grid"><div class="b-grid-h"><div class="b-grid-head _head-h{cid} _head{cid} _cols{cid}"></div><div class="b-grid-body _body-h{cid}"><table class="table table-striped table-hover"><colgroup class="_cols{cid}"></colgroup><tbody class="_body{cid}"></tbody></table></div></div><div class="b-grid-empty _empty{cid}">{emptytext}</div></div>'),
q=_.template('<div class="b-grid-th align_{align} _col{cid}"><div class="b-grid-th-h _hover{cid}">{text}</div></div>'),n=_.template('<tr data-id={id} class="b-grid-row _row{cid}">{items}</tr>'),t=_.template('<td class="b-grid-td t-bg align_{align}"><div class="b-grid-td-h _td{cid} _hover{cid}">{text}</div></td>')})(App);
(function(b){function e(b){if(this._isOpen)c.call(this,b);else{var e=this;this._isOpen=!0;clearTimeout(this._closeAction);setTimeout(function(){$(window).on(e._windowListeners)},0);if("submenu"==this._type){this.$el.appendTo(this._targetEl).show();var f,h,b=this._position,n="down",t;h=$(window);t=h.width();var r=h.height(),s=h.scrollTop(),u=h.scrollLeft(),p=this._targetEl.offset();f=this.$el.outerWidth();h=this.$el.outerHeight();"right"==b&&(t=t+u-p.left-this._targetEl.outerWidth()-f,0>t&&(b="left"));
"down"==n&&(t=r+s-p.top-h,0>t&&(n="up"));this.$el.css({left:"right"==b?"100%":"-100%",top:"down"==n?0:-h+this._targetEl.outerHeight()+12});this.$el.hide().fadeIn(50)}else n=$(window),b=this._position,s=n.width(),h=n.height(),t=n.scrollTop(),u=n.scrollLeft(),p=this._targetEl.offset(),f=p.left+this._targetEl.outerWidth()/2<s/2+u?"left":"right",this.$el.appendTo("body").show(),n=this.$el.outerWidth(),r=this.$el.outerHeight(),"bottom"==b?(s=h+t-p.top-this._targetEl.outerHeight()-r,0>s&&(b="top")):"top"==
b?(s=p.top-r-t,0>s&&(b="bottom")):"left"==b?(s=p.left-n-u,0>s&&(b="right")):"right"==b&&(s=s+u-p.left-this._targetEl.outerWidth()-n,0>s&&(b="left")),"bottom"==b?this.$el.css({top:p.top+this._targetEl.outerHeight()+d,left:"right"==f?p.left+this._targetEl.outerWidth()-n:p.left}):"top"==b?this.$el.css({top:p.top-r-d,left:"right"==f?p.left+this._targetEl.outerWidth()-n:p.left}):"left"==b?this.$el.css({top:p.top,left:p.left-n+d}):"right"==b&&this.$el.css({top:p.top,left:p.left+this._targetEl.outerWidth()-
d}),this.$el.on({mouseleave:function(){a.call(e)},mouseenter:function(){clearTimeout(e._autoHide)}}),this.$el.hide().fadeIn(50),this.trigger("dropdownshow")}}function a(){var a=this;this._autoHide=setTimeout(function(){c.call(a)},1E3)}function c(){if(this._isOpen){var a=this;this._isOpen=!1;this._closeAction=setTimeout(function(){a.$el.fadeOut(50,function(){$(this).detach();a.$el.off("mouseenter mouseleave")})},0);$(window).off(this._windowListeners);this.trigger("dropdownhide")}}b.defineView("Dropdown",
{tagName:"ul",className:"b-dropdown dropdown-menu",options:{target:null,position:"bottom",event:"click",type:"menu"},init:function(){var a=this;this.setPosition(this.options.position);this.setEvent(this.options.event);this.setType(this.options.type);this.setTarget(this.options.target);this._windowListeners={"mouseup touchend scroll":function(b){c.call(a,b)}}},doRender:function(){this._listEl=this.$el;return this},addButton:function(a,b,c){var d,a=$(f({cid:this.cid})).append(a.$el||a);c&&(a.addClass("dropdown-submenu").on("mouseup touchend",
function(a){$(a.target).closest("li").get(0)==this&&a.stopPropagation()}),c.setTarget(a).setType("submenu").setPosition("right").setEvent("hover"));null!==b&&0<=b&&(d=this._listEl.find("._item"+this.cid+":eq("+b+")"));d?a.insertBefore(d):(this._listEl.append(a),b=this._listEl.find("._item"+this.cid).length-1);this.trigger("addbutton",b);return this},getButtonIndex:function(a){a=a.$el||a;return this._listEl.find("._item"+this.cid).index(a.parent())},removeButton:function(a){this._listEl.find("._item"+
this.cid+":eq("+a+")").remove();return this},setType:function(a){this._type=a;return this},setPosition:function(a){this._position=a;return this},setEvent:function(a){var b=this;this._targetEl&&this._targetEl.off(this._targetListeners);this._event=a;a={};a[this._event]=function(a){e.call(b,a)};this._targetListeners=a;if(this._targetEl)this._targetEl.on(this._targetListeners);return this},addSeparator:function(a){var b,c=$(h());0<=a&&(b=this._listEl.find("._item"+this.cid+":eq("+a+")"));b?c.insertAfter(b):
this._listEl.append(c);return this},setActive:function(a){this.$el.find("._item"+this.cid+".active").removeClass("active").find("._item"+this.cid+":eq("+a+")").addClass("active")},setTarget:function(a){if(!a)return this;this._targetEl&&this._targetEl.off(this._targetListeners);this._targetEl=a.$el||a;this._targetEl.on(this._targetListeners);return this}});var d=2,f=_.template('<li class="_item{cid}"></li>'),h=_.template('<li class="divider"></li>')})(App);
(function(b){function e(a){return this._groupsMenuEl.find(">[data-index="+a+"]")}function a(){var a=this;this._resizeDelay&&clearTimeout(this._resizeDelay);this._resizeDelay=setTimeout(function(){c.call(a)},100)}function c(){var a=this.options.maxTabWidth;this._groupsMenuEl.children().each(function(){var b=$(this);b.width()>=a?(b.addClass("max_width"),b.find(".title").width(a)):(b.removeClass("max_width"),b.find(".title").width("auto"))});var b=this,c=$(this._groupsMenuEl).width(),d=this._groupsMenuEl.find(".dropdown"),
h=$(d).width();if(c){var j={},k={},l;l=[];for(var m in this._tabsOpenTimes)l.push({id:parseInt(m,10),time:this._tabsOpenTimes[m]});l=l.sort(function(a,b){return a.time!=b.time?b.time-a.time:b.id-a.id});var v,z=0,g;for(g in l)v=l[g].id,m=e.call(b,v),h+=m.width(),-1==m.attr("class").indexOf("more")&&(h>c?(z++,b._hidddenTabs[v]||(m.hide(),j[v]=v,b._hidddenTabs[v]=new f({text:m.find(".title").text(),click:function(a){return function(){b.activeTab(a)}}(v)}))):b._hidddenTabs[v]&&(k[v]=b._hidddenTabs[v],
delete b._hidddenTabs[v],m.show()));z?d.show():d.hide();for(g in k)((c=b.dropdownTabs.getButtonIndex(k[g]))||0===c)&&b.dropdownTabs.removeButton(c);for(var w in j)k=b._hidddenTabs[j[w]],-1===b.dropdownTabs.getButtonIndex(k)&&b.dropdownTabs.addButton(k)}}b.defineView("Tabbar",{options:{maxTabWidth:200},tagName:"div",className:"b-tabbar-h",init:function(){},doRender:function(){var b=this;this.$el.append($(h({cid:this.cid})));this.$el.append($(m({cid:this.cid})));this._groupsMenuEl=this.$el.find("._tabbar"+
this.cid);this._groupsTabsEl=this.$el.find("._tabbar_content"+this.cid);this._tabComponents={};this._hidddenTabs={};this._disabledTabs={};this._tabsOpenTimes={};this.dropdownTabs=new d;moreButton=new f({text:"...",menu:this.dropdownTabs});this._groupsMenuEl.on("click",".active",function(a){a.stopPropagation();((a=$(this).parent().data("index"))||0===a)&&b.activeTab(parseInt(a,10))});this._groupsMenuEl.on("click",".tab-close",function(a){a.stopPropagation();a=$(this).parent().data("index");b.removeTab(a)});
this._groupsMenuEl.find(".dropdown").append(moreButton.$el);a.call(this);return this},doLayout:function(){a.call(this);var b=this._tabComponents[this._activeIndex];b&&b.layout&&b.layout()},addTab:function(b,c,d,f){var h=-1;!d&&0!==d&&(this._groupsTabsEl.children().each(function(){var a=$(this).data("index"),a=a&&parseInt(a,10);h=h<a?a:h}),d=h+1);this._tabsOpenTimes[d]=(new Date).getTime();this._tabComponents[d]=b;var m=d,p=e.call(this,m),l=this._groupsMenuEl.find(".more");p.length||(0===p.length&&
(p=$(j()).attr("data-index",m),this._groupsMenuEl.children().each(function(){if($(this).data("index")>m)return p.insertBefore($(this)),!1}),0===this._groupsMenuEl.has(p).length&&p.insertBefore($(l))),c='<a href="javascript:void(0);" class="title active">'+c+"</a>",f&&(c+='<a class="tab-close"></a>'),p.append($(c)));var x=d,v=this._groupsTabsEl.find(">[data-index="+x+"]");0===v.length&&(v=$(k({cid:this.cid})).attr("data-index",x),this._groupsTabsEl.children().each(function(){if($(this).data("index")>
x)return v.insertBefore($(this)),!1}),0===this._groupsTabsEl.has(v).length&&this._groupsTabsEl.append(v));v.data("component",b).append(b.$el||b);a.call(this);this.trigger("addtab",d);return this},removeTab:function(b){var c=e.call(this,b),d=this._groupsTabsEl.find(">[data-index="+b+"]");if(!c||!d)return this;c.remove();d.remove();if(c=this._hidddenTabs[b])((c=this.dropdownTabs.getButtonIndex(c))||0===c)&&this.dropdownTabs.removeButton(c),delete this._hidddenTabs[b];delete this._tabsOpenTimes[b];delete this._tabComponents[b];
a.call(this);this.trigger("removetab",b);var f=this,h={},j;for(j in this._hidddenTabs)f._disabledTabs[j]||(h[j]=j);this._groupsMenuEl.children().each(function(){var a=$(this).data("index"),b=a&&parseInt(a,10),c=f._disabledTabs[b];if((a||0===a)&&!c)h[b]=b});var k,m,x;for(x in h)if(j=Math.abs(h[x]-b),j<m||!m)m=j,k=h[x];this.activeTab(k);return this},setTitle:function(b,c){var c=c||"",d=e.call(this,b);d&&d.find(".title").text(c);(d=this._hidddenTabs[b])&&d.setText(c);a.call(this);return this},getTab:function(a){return this._tabComponents[a]},
getTabIndex:function(a){var b=null;$.each(this._tabComponents,function(c,d){if(a===d||a===d.$el)b=c});return b},activeTab:function(b,c){if(this._activeIndex==b)return this;this._tabsOpenTimes[b]=(new Date).getTime();var d={},f=this._activeIndex;c||this.trigger("beforetabchange",d,b,f);if(d.cancel)return this;this._activeIndex=b;d=e.call(this,b);this._groupsMenuEl.children().each(function(){$(this).removeClass("active")});d.addClass("active");tabEl=this._groupsTabsEl.find(">[data-index="+b+"]");this._groupsTabsEl.children().each(function(){$(this).hide()});
tabEl.fadeIn(200);d=this._tabComponents[b];d.layout&&d.layout();a.call(this);c||this.trigger("tabchange",b,f);return this},disableTab:function(a){e.call(this,a).find("a").removeClass("active").addClass("disabled");this._disabledTabs[a]=!0;this._hidddenTabs[a]&&this._hidddenTabs[a].disable();return this},layout:function(){this.parent().layout.apply(this,arguments);this._activeIndex&&this.activeTab(this._activeIndex)},enableTab:function(a){e.call(this,a).find("a").addClass("active").removeClass("disabled");
delete this._disabledTabs[a];this._hidddenTabs[a]&&this._hidddenTabs[a].enable();return this}});var d=b.getView("Dropdown"),f=b.getView("Button"),h=_.template('<ul class="nav nav-tabs b-tabbar _tabbar{cid}"><li class="dropdown open more menu-item"></li></ul>'),j=_.template('<li class="menu-item"></li>'),k=_.template('<div class="tab_container" style="display: none"></div>'),m=_.template('<div class="_tabbar_content{cid}"></div>')})(App);
(function(){function b(a){if(a){var b=this;this._popupEditFunction||(this._popupEditFunction=new (App.getView("EditClassFunctionPopup"))({listeners:{save:function(a,c){this.close();a&&b._gridFunctions.collection.add([c],{silent:!1})}}}));this._popupEditFunction.setModel(a).open()}}function e(a){if(a){var b=this;this._popupEditFunctionField||(this._popupEditFunctionField=new (App.getView("EditClassFunctionFieldPopup"))({listeners:{save:function(a,c){this.close();a&&(0===b._activeTab?b._gridFunctionFieldsInput.collection.add([c],
{silent:!1}):b._gridFunctionFieldsOutput.collection.add([c],{silent:!1}))}}}));this._popupEditFunctionField.setModel(a).open()}}function a(a){a&&(this._gridFunctionFieldsInput.setCollection(a.getCollectionFields("input")),this._gridFunctionFieldsOutput.setCollection(a.getCollectionFields("output")))}function c(a){var b=this,c=new h({tooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u0435",size:"small",icon:"icon-plus",click:function(){var c=b._gridFunctions.getSelection(),
c=b._gridFunctions.collection.get(c[0]).id;e.call(b,new k({FunctionId:c,type:a}))}}),f=new h({disabled:!0,tooltip:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u0435",size:"small",icon:"icon-edit",click:function(){var a=s.getSelection(),a=s.collection.get(a[0]);e.call(b,a)}}),j=new h({disabled:!0,size:"small",tooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u0435",icon:"icon-remove",click:function(){App.msg.okcancel({title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044f",
text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u0435?",callback:function(){var a=s.getSelection();(a=s.collection.get(a[0]))&&a.destroy({wait:!0,silent:!1})}})}}),s=new d({selectable:!0,columns:[{name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",key:"Name",width:1},{name:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",key:"Info",width:3},{name:"\u0422\u0438\u043f",
key:"Datatype",width:1,render:function(a){return k.fieldTypes[a]}},{name:"\u0417\u0430\u043f\u0440\u0435\u0442 null",key:"isNull",width:100,align:"center"},{name:"\u041c\u0430\u0441\u0441\u0438\u0432",key:"isArray",width:100,align:"center",render:function(a){return 0<a?a:!1}}],listeners:{selectionchange:function(a){this.collection.get(a)?(f.enable(),j.enable()):(f.disable(),j.disable())}}});return{grid:s,addButton:c,editButton:f,removeButton:j}}App.defineView("EditPanelClassFunction",{extend:"Container",
options:{fluid:!0,model:null},init:function(){this.parent().init.apply(this,arguments)},doRender:function(){this.parent().doRender.apply(this,arguments);var e=this;new (App.getCollection("ClassFunction"));var k=new h({tooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e",size:"small",icon:"icon-plus",click:function(){b.call(e,new j({ClassId:e.model.id}))}}),n=new h({disabled:!0,tooltip:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e",
size:"small",icon:"icon-edit",click:function(){var a=r.getSelection(),a=r.collection.get(a[0]);b.call(e,a)}}),t=new h({disabled:!0,size:"small",tooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e",icon:"icon-remove",click:function(){App.msg.okcancel({title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438",text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u044e?",
callback:function(){var a=r.getSelection();(a=r.collection.get(a[0]))&&a.destroy({wait:!0,silent:!1})}})}}),r=new d({selectable:!0,columns:[{name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",key:"Name",width:1},{name:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",key:"Info",width:3},{name:"\u0422\u0438\u043f",key:"Type",width:1,render:function(a){return j.functionTypes[a]}}],listeners:{selectionchange:function(b){(b=this.collection.get(b))?(n.enable(),t.enable()):(n.disable(),t.disable());
a.call(e,b);b?x.show():x.hide()}}}),s=c.call(this,"input"),u=c.call(this,"output"),p=s.grid,l=u.grid,x=(new f({listeners:{beforetabchange:function(a,b){e._activeTab=b}}})).addTab(p,"\u0412\u0432\u043e\u0434",0).addTab(l,"\u0412\u044b\u0432\u043e\u0434",1).activeTab(0).hide();r.getToolbar().add(k,1).add(n,2).add(t,2);this.add(r);this.add(x);p.getToolbar().add(s.addButton,1).add(s.editButton,2).add(s.removeButton,2);l.getToolbar().add(u.addButton,1).add(u.editButton,2).add(u.removeButton,2);this._gridFunctions=
r;this._gridFunctionFieldsInput=p;this._gridFunctionFieldsOutput=l},layout:function(){this.parent().layout.apply(this,arguments);this._gridFunctions.layout()},setModel:function(a){if(!a)return this;this.model=a;this._gridFunctions.setCollection(a.getCollectionFunctions());return this}});var d=App.getView("Grid"),f=App.getView("Tabbar");App.getView("Container");var h=App.getView("Button"),j=App.getModel("ClassFunction"),k=App.getModel("ClassFunctionField")})();
(function(){App.defineView("ClassFieldSubtypePopup",{extend:"Popup",options:{popupWidth:500},init:function(){this.parent().init.apply(this,arguments)},doRender:function(){this.parent().doRender.apply(this,arguments);var b=App.getView("Grid"),e=App.getView("Button"),a=new e({tooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",size:"small",icon:"icon-plus",click:function(){}}),c=new e({disabled:!0,size:"small",tooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",
icon:"icon-remove",click:function(){var a=d.getSelection(),b=d.collection.get(a[0]);App.msg.okcancel({title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f",text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435?",callback:function(){b&&b.destroy({wait:!0,silent:!1})}})}}),d=new b({selectable:!0,
reorderable:!0,columns:[{name:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",key:"Value",width:1}],listeners:{selectionchange:function(a){this.collection.get(a)?c.enable():c.disable()},moverow:function(a,b){var c=this.collection.get(a);c&&c.changePosition(b)}}});d.getToolbar().add(a,1).add(c,2);this.add(d);this._gridSubtypes=d;return this},setModel:function(b){if(b)return this.setTitle("\u0421\u0430\u0431\u0442\u0438\u043f\u044b \u043f\u043e\u043b\u044f "+b.get("Name")),this.model=b,this._gridSubtypes.setCollection(b.getCollectionSubtypes()),
this}})})();
(function(){function b(){var b=parseInt(this._form.getField("Type").getValue(),10);this._fieldTypeDetails&&(7===b?this._fieldTypeDetails.show():this._fieldTypeDetails.hide())}App.defineView("EditClassFieldPopup",{extend:"Popup",options:{popupWidth:500},init:function(){this.parent().init.apply(this,arguments)},doRender:function(){this.parent().doRender.apply(this,arguments);var e=this,a=App.getView("Form"),c=App.getView("FieldTextarea"),d=App.getView("FieldText"),f=App.getView("FieldSelect"),h=App.getView("FieldCheckbox"),
j=App.getView("Button"),k=new d({label:"ID",readonly:!0,name:"id"}),m=new d({label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"Name"}),c=new c({label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",name:"Description"}),j=new j({text:"...",click:function(){e.model.id?(e._fieldSubtypePopup||(e._fieldSubtypePopup=new (App.getView("ClassFieldSubtypePopup"))),e._fieldSubtypePopup.setModel(e.model).open()):App.msg.warning({title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u0435",
text:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0438\u0431\u0442\u0438\u043f\u043e\u0432 \u043d\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u0435\u0439.<br>\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u0435 \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435."})}}),f=new f({width:175,label:"\u0422\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445",
name:"Type",options:App.getModel("ClassField").fieldTypes,details:j}),d=new d({label:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e",name:"Default"}),q=new h({label:"\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0435",name:"Unique"}),h=new h({label:"Not null",name:"Required"}),a=(new a({listeners:{save:function(a){var b=this.getModel();e.trigger("save",a,b)}}})).add(m).add(c).add(f).add(d).add(q).add(h).add(k);k.hide();this.add(a);this._form=a;this._fieldName=m;this._fieldDescription=
c;this._fieldTypeDetails=j;this._fieldType=f;this._fieldDefault=d;this._fieldUnique=q;this._fieldRequired=h;j.hide();this._form.getField("Type").on("change",b,this);this.setModel(this.model);return this},setLocal:function(b){this._form.setLocal(b);return this},setModel:function(b){if(b)return this.setTitle(b.id?"\u041f\u043e\u043b\u0435 "+(b.get("Name")||""):"\u041d\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435"),this.model=b=b||new ModelClassField({}),this._form.setModel(b),this._fieldName.setReadOnly(b.id&&
!0),this._fieldType.setReadOnly(b.id&&!0),this._fieldUnique.setReadOnly(b.id&&!0),this._fieldRequired.setReadOnly(b.id&&!0),this},close:function(){var b=this,a=this.parent().close;this._form.askIfDirty(function(){a.apply(b,arguments)});return b}})})();
(function(){App.defineView("NestedList",{options:{path:null,collection:null,listMinWidth:200,emptyText:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"},tpl:_.template('<div class="b-nestedlist _lists{cid}"></div>'),tplList:_.template('<div class="b-nestedlist-lists-hh _list{cid}"><div class="b-nestedlist-lists-h _scroll{cid}"><table class="table table-hover _items{cid}"></table><div class="b-nestedlist-empty _empty{cid}">{emptytext}</div></div></div>'),tplItem:_.template('<tr class="b-nestedlist-item t-bg _item{cid}"><td class="t-bg" >{item}</td></tr>'),
init:function(){var b=this;this.$el.on("click","._item"+this.cid,function(){b.select($(this).data("path"))});this._state={path:this.options.path||this.collection.rootPath,offset:0}},doRender:function(){this.$el.append($(this.tpl({cid:this.cid})));this._listsEl=this.$el.find("._lists"+this.cid);this.updateLists();return this},doPresenter:function(){var b=this;this._presenterOnce||(this.on("remove",function(){this.collection.off(null,null,this)}),this._presenterOnce=!0);this.collection.on("reset",function(){},
this).on("add",function(e){e=b.collection.getPath(e);e=b.collection.getParent(e);b.renderList(e)},this).on("remove",function(e){var e=this.collection.getPath(e),a=this.collection.getParent(e),c=this._lists[a];c&&c.find('[data-path="'+e+'"]').fadeOut(200,function(){$(this).remove()});-1!=this._state.path.search(e)&&this.select(a);0==this.collection.getChildren(a).length&&b.renderList(a)},this)},updateLists:function(b){var e=this,a=Math.max(1,Math.min(6,Math.floor(this.$el.width()/this.options.listMinWidth))),
c=this.collection.pathToArray(this._state.path),d=c.length,f=this.collection.isLeaf(this._state.path),h=[],j,k,m,q=[],a=Math.min(d+(f?0:1),a);j=Math.min(d+(f?0:1)-a,this._state.offset);this._lists||(this._lists=[]);for(var n=d-a-j-(f?1:0);n<d-j-(f?1:0);n++)k=c[n]||this.collection.rootPath,f&&n==c.length-1||(this._lists[k]?a=this._lists[k]:(a=$(this.tplList({cid:this.cid,emptytext:this.options.emptyText})).data("path",k),m=new (App.getView("ToolbarHover")),m.add(new (App.getView("Button"))({icon:"icon-refresh",
type:"small",listeners:{click:function(){e.refreshList(this.$el.closest("._list"+e.cid).data("path"))}}}),10),m.setPanel(a),a.data("toolbar",m),this.trigger("appendlist",k,m),q.push(a)),h.push(a),h[k]=a);c=(100-2.5*(h.length-1))/h.length+"%";j=this._listsEl.children().attr("_hide",1);for(n=0;n<h.length;n++)a=h[n],j.index(a)!=n&&(f=a.children().eq(0),d=f.scrollTop(),a.appendTo(this._listsEl),f.scrollTop(d)),a.width(c).removeAttr("_hide");this._listsEl.children("[_hide]").remove();this._lists=h;for(n=
0;n<q.length;n++)k=q[n].data("path"),this.collection.isFetched(k)?this.renderList(k):this.refreshList(k);this.updatePath(b);return this},updatePath:function(){var b=this.collection.pathToArray(this._state.path),e,a;(a=this._lists[this._state.path])&&a.find("._item"+this.cid+".state_active,").removeClass("state_active");for(var c=-1;c<b.length-1;c++)if(e=this._lists[b[c]||this.collection.rootPath])a=e.find("._item"+this.cid+'[data-path="'+b[c+1]+'"]'),0<a.length&&!a.is(".state_active")&&(e.find("._item"+
this.cid+".state_active,").removeClass("state_active"),e=e.find("._scroll"+this.cid),e.animate({scrollTop:a.offset().top-a.parent().offset().top-e.height()/2+a.height()/2},200)),a.addClass("state_active")},refreshList:App.debounce(function(b){this.fetchNode(b)},100,!1,!0),renderList:function(b){var e=this._lists[b];if(e){for(var b=this.collection.getChildren(b),a=0==e.children().length,c=[],d=0;d<b.length;d++)c.push($(this.tplItem({cid:this.cid,item:this.collection.getName(b[d])})).attr("data-path",
this.collection.getPath(b[d])).get(0));0==b.length?(c=e.find("._items"+this.cid).hide().end().find("._empty"+this.cid).show(),App.view.applyInset(c)):c=$(c).appendTo(e.find("._empty"+this.cid).hide().end().find("._items"+this.cid).show().children().remove().end());a&&c.hide().fadeIn(200)}},fetchNode:function(b){var e=this,a=this._lists[b];App.view.setLoading(a,!0);this.collection.fetchNode(b,{silent:!0,presenter:this,success:function(){e.renderList(b);e.updatePath()},complete:function(){App.view.setLoading(a,
!1)}})},getListNode:function(b){if(this._state.path!=b&&this._state.path)return"/"==b&&(b=""),b+/\/[^\/]+/.exec(this._state.path.replace(b))[0]},select:function(b,e){if(b!=this._state.path){var a=_.clone(this._state),c={};e||this.trigger("beforeselectionchange",c,[b],[a.path]);if(c.cancel)return this;this._state.path=b;this.updateLists(a);e||this.trigger("selectionchange",[b],[a.path]);return this}},getListToolbar:function(b){return(b=this._lists[b])?b.data("toolbar"):null},isSelectedList:function(b){return b!=
this._state.path},getLists:function(){for(var b=[],e=0;e<this._lists.length;e++)b.push(this._lists[e].data("path"));return b},getToolbar:function(){}})})();
(function(){function b(a){if(a){var b=this;this._popupEditField||(this._popupEditField=new (App.getView("EditClassFieldPopup"))({listeners:{save:function(a,c){this.close();a&&b._gridFields.collection.add([c],{silent:!1})}}}));this._popupEditField.setLocal(this._gridFields.collection.isLocal()).setModel(a).open()}}function e(a){a?(this._form.setLegend("\u041a\u043b\u0430\u0441\u0441 "+a.get("ClassName")).setModel(a),this._tabbar.enableTab(2).show(),this._fieldName.setReadOnly(!0),this._fieldSystem.show(),
this._fieldWorkspaceId.show(),this._fieldAllWorkspace.hide(!0),this._gridFields.setCollection(a.getCollectionFields()),this._viewFunctions.setModel(a),a.get("System")?this._addFieldButton.disable():this._addFieldButton.enable()):this._tabbar.hide()}function a(a){this._form.askIfDirty(function(){var b=new this.collection.model({parent:a});this._form.setLegend("\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e "+("/"!=a?"\u0434\u043e\u0447\u0435\u0440\u043d\u0435\u0433\u043e":
"")+" \u043a\u043b\u0430\u0441\u0441\u0430").setModel(b);this._tabbar.disableTab(2).activeTab(0).show();this._gridFields.setCollection(b.getCollectionFields());this._addFieldButton.enable();this._fieldSystem.hide(!0);this._fieldName.setReadOnly(!1);this._fieldWorkspaceId.hide(!0);this._fieldAllWorkspace.show()},this)}App.defineView("EditPanelClass",{extend:"Container",options:{fluid:!0,collection:new (App.getCollection("Class"))},init:function(){this.parent().init.apply(this,arguments);this.$el.addClass("b-classeditpanel")},
doRender:function(){this.parent().doRender.apply(this,arguments);var d=this;this.add(c({cid:this.cid}));this._listEl=this.$el.find("._nestedlist"+this.cid);this._nestedlist=new (App.getView("NestedList"))({collection:this.collection,el:this._listEl,emptyText:"\u041d\u0435\u0442 \u043a\u043b\u0430\u0441\u0441\u043e\u0432",listeners:{appendlist:function(b,c){buttonDelete=new (App.getView("Button"))({disabled:!0,tooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043b\u0430\u0441\u0441",size:"small",
icon:"icon-remove",click:function(){App.msg.okcancel({title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0430",text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043b\u0430\u0441\u0441?",callback:function(){var a=d.collection.getNode(d._nestedlist.getListNode(b));a&&a.destroy({wait:!0,silent:!1})}})}});buttonAdd=new (App.getView("Button"))({tooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043b\u0430\u0441\u0441",
size:"small",icon:"icon-plus",click:function(){d._nestedlist.select(b,!0);a.call(d,b)}});c.add(buttonAdd,1).add(buttonDelete,1);c.buttonDelete=buttonDelete;c.buttonAdd=buttonAdd},beforeselectionchange:function(a,b){a.cancel=!0;d._form.askIfDirty(function(){this.select(b[0],!0);for(var a=this.getLists(),c,f,h,i=b[0],j=0;j<a.length;j++)c=this.getListToolbar(a[j]),f=d.collection.getNode(a[j]),h=d.collection.getNode(this.getListNode(a[j])),this.isSelectedList(a[j])&&h&&!h.get("System")?c.buttonDelete.enable():
c.buttonDelete.disable(),!f||!f.get("System")?c.buttonAdd.enable():c.buttonAdd.disable();e.call(d,d.collection.getNode(i))},this)}}});var f=App.getView("Tabbar"),h=App.getView("Form"),j=App.getView("FieldTextarea"),k=App.getView("FieldText"),m=App.getView("FieldCheckbox");App.getView("Container");var q=App.getView("Button"),n=this.collection.model.getModelClassField(),t=App.getView("Grid"),r=new (App.getView("EditPanelClassFunction")),s=new q({disabled:!0,tooltip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u0435",
size:"small",icon:"icon-plus",click:function(){var a=d._form.getModel().id;b.call(d,new (d.collection.model.getModelClassField())({ClassId:a}))}}),u=new q({disabled:!0,tooltip:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u043b\u0435",size:"small",icon:"icon-edit",click:function(){var a=l.getSelection(),a=l.collection.get(a[0]);b.call(d,a)}}),p=new q({disabled:!0,size:"small",tooltip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u0435",icon:"icon-remove",click:function(){var a=
l.getSelection(),b=l.collection.get(a[0]);b&&!b.id?l.collection.remove([b],{silent:!1}):App.msg.okcancel({title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044f",text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u0435?",callback:function(){b&&b.destroy({wait:!0,silent:!1})}})}}),l=new t({selectable:!0,columns:[{name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",
key:"Name",width:1},{name:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",key:"Description",width:3},{name:"\u0422\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445",key:"Type",width:1,render:function(a){return n.fieldTypes[a]}},{name:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e",key:"Default",width:1},{name:"\u041d\u0435 \u043f\u0443\u0441\u0442\u043e",key:"Required",width:100,align:"center"},{name:"\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e",key:"Unique",width:100,
align:"center"},{name:"\u0412\u043d\u0435\u0448\u043d\u0435\u0435",key:"External",width:100,align:"center"}],listeners:{selectionchange:function(a){(a=this.collection.get(a))?u.enable():u.disable();a&&a.get("External")?p.enable():p.disable()}}}),q=new k({label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0430",name:"ClassName"}),t=new m({label:"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439",readonly:!0,name:"System"}),m=new m({label:"\u0414\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043e\u0431\u043b\u0430\u0441\u0442\u0435\u0439",
name:"AllWorkspace"}),k=new k({label:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0447\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c",readonly:!0,name:"WorkspaceId"}),h=(new h({listeners:{beforesave:function(a,b,c){if(b){this.getModel();var d=[];l.collection.each(function(a){d.push(a.attributes)});0==d.length?(a.cancel=!0,App.msg.warning({title:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u044f \u043a\u043b\u0430\u0441\u0441\u0430",
text:"\u041f\u0435\u0440\u0435\u0434 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u043d\u043e\u0432\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0435\u0433\u043e \u043f\u043e\u043b\u044f"}),x.activeTab(1)):c._fields=d}},save:function(a){var b=this.getModel();a&&(d.collection.add([b],{silent:!1}),d._nestedlist.select(d.collection.getPath(b)),d._gridFields.setCollection(b.getCollectionFields()))}}})).add(q).add(new j({label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0430",
name:"ClassInfo"})).add(t).add(m).add(k),x=(new f({listeners:{beforetabchange:function(a,b,c){d._form&&(0==c&&d._form.getModel().id)&&(a.cancel=!0,d._form.askIfDirty(function(){this.activeTab(b,!0)},this))}}})).addTab(h,"\u0421\u0432\u043e\u0439\u0441\u0442\u0432\u0430",0).addTab(l,"\u041f\u043e\u043b\u044f",1).addTab(r,"\u0424\u0443\u043d\u043a\u0446\u0438\u0438",2).activeTab(0).hide();l.getToolbar().add(s,1).add(u,2).add(p,2);this._addFieldButton=s;this.add(x);this._form=h;this._tabbar=x;this._gridFields=
l;this._viewFunctions=r;this._fieldName=q;this._fieldSystem=t;this._fieldAllWorkspace=m;this._fieldWorkspaceId=k;return this},doPresenter:function(){this.parent().doPresenter.apply(this,arguments)}});var c=_.template('<div class="b-classeditpanel-nestedlist _nestedlist{cid}"></div>')})();
