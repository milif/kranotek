App.defineView("Button",{tagName:"a",className:"btn",attributes:{href:"javascript:void(0)"},options:{icon:null,text:null,size:null,type:null,tooltip:null,disabled:null},init:function(){var b=this;if(this.options.click)this.on("click",this.options.click);this.$el.on("click",function(){$(this).is(".disabled")?b.trigger("disableclick"):b.trigger("click")})},doRender:function(){this.options.size&&this.$el.addClass("btn-"+this.options.size);this.options.icon&&this.$el.append('<i class="'+this.options.icon+
'"></i>');this.options.text&&this.$el.append(this.options.text);this.options.type&&this.$el.addClass("btn-"+this.options.type);this.options.menu&&(this.$el.addClass("dropdown-toggle").append('&nbsp;<span class="caret"></span>'),this.options.menu.setTarget(this));this.options.tooltip&&new (App.getView("Tooltip"))({target:this.$el,text:this.options.tooltip,position:"bottom"});this.options.disabled&&this.disable();return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},enable:function(){this.$el.removeClass("disabled");
return this},disable:function(){this.$el.addClass("disabled");return this},setText:function(b){this.$el.text(b||"")}});
(function(){function b(a,f,j){if(a===f)return 0!==a||1/a==1/f;if(null==a||null==f)return a===f;a._chain&&(a=a._wrapped);f._chain&&(f=f._wrapped);if(a.isEqual&&d.isFunction(a.isEqual))return a.isEqual(f);if(f.isEqual&&d.isFunction(f.isEqual))return f.isEqual(a);var e=m.call(a);if(e!=m.call(f))return!1;switch(e){case "[object String]":return a==String(f);case "[object Number]":return a!=+a?f!=+f:0==a?1/a==1/f:a==+f;case "[object Date]":case "[object Boolean]":return+a==+f;case "[object RegExp]":return a.source==
f.source&&a.global==f.global&&a.multiline==f.multiline&&a.ignoreCase==f.ignoreCase}if("object"!=typeof a||"object"!=typeof f)return!1;for(var c=j.length;c--;)if(j[c]==a)return!0;j.push(a);var c=0,g=!0;if("[object Array]"==e){if(c=a.length,g=c==f.length)for(;c--&&(g=c in a==c in f&&b(a[c],f[c],j)););}else{if("constructor"in a!="constructor"in f||a.constructor!=f.constructor)return!1;for(var u in a)if(d.has(a,u)&&(c++,!(g=d.has(f,u)&&b(a[u],f[u],j))))break;if(g){for(u in f)if(d.has(f,u)&&!c--)break;
g=!c}}j.pop();return g}var i=this,a=i._,e={},c=Array.prototype,g=Object.prototype,h=c.slice,p=c.unshift,m=g.toString,t=g.hasOwnProperty,q=c.forEach,v=c.map,w=c.reduce,z=c.reduceRight,B=c.filter,r=c.every,l=c.some,s=c.indexOf,y=c.lastIndexOf,g=Array.isArray,x=Object.keys,C=Function.prototype.bind,d=function(a){return new D(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=d),exports._=d):i._=d;d.VERSION="1.3.3";var k=d.each=d.forEach=function(a,
f,b){if(null!=a)if(q&&a.forEach===q)a.forEach(f,b);else if(a.length===+a.length)for(var j=0,c=a.length;j<c&&!(j in a&&f.call(b,a[j],j,a)===e);j++);else for(j in a)if(d.has(a,j)&&f.call(b,a[j],j,a)===e)break};d.map=d.collect=function(a,f,d){var b=[];if(null==a)return b;if(v&&a.map===v)return a.map(f,d);k(a,function(a,n,j){b[b.length]=f.call(d,a,n,j)});a.length===+a.length&&(b.length=a.length);return b};d.reduce=d.foldl=d.inject=function(a,f,b,j){var c=2<arguments.length;null==a&&(a=[]);if(w&&a.reduce===
w)return j&&(f=d.bind(f,j)),c?a.reduce(f,b):a.reduce(f);k(a,function(a,d,n){c?b=f.call(j,b,a,d,n):(b=a,c=!0)});if(!c)throw new TypeError("Reduce of empty array with no initial value");return b};d.reduceRight=d.foldr=function(a,f,b,j){var c=2<arguments.length;null==a&&(a=[]);if(z&&a.reduceRight===z)return j&&(f=d.bind(f,j)),c?a.reduceRight(f,b):a.reduceRight(f);var e=d.toArray(a).reverse();j&&!c&&(f=d.bind(f,j));return c?d.reduce(e,f,b,j):d.reduce(e,f)};d.find=d.detect=function(a,f,d){var b;A(a,function(a,
n,j){if(f.call(d,a,n,j))return b=a,!0});return b};d.filter=d.select=function(a,f,d){var b=[];if(null==a)return b;if(B&&a.filter===B)return a.filter(f,d);k(a,function(a,n,j){f.call(d,a,n,j)&&(b[b.length]=a)});return b};d.reject=function(a,f,d){var b=[];if(null==a)return b;k(a,function(a,n,j){f.call(d,a,n,j)||(b[b.length]=a)});return b};d.every=d.all=function(a,f,d){var b=!0;if(null==a)return b;if(r&&a.every===r)return a.every(f,d);k(a,function(a,j,n){if(!(b=b&&f.call(d,a,j,n)))return e});return!!b};
var A=d.some=d.any=function(a,f,b){f||(f=d.identity);var j=!1;if(null==a)return j;if(l&&a.some===l)return a.some(f,b);k(a,function(a,d,n){if(j||(j=f.call(b,a,d,n)))return e});return!!j};d.include=d.contains=function(a,f){var d=!1;return null==a?d:s&&a.indexOf===s?-1!=a.indexOf(f):d=A(a,function(a){return a===f})};d.invoke=function(a,f){var b=h.call(arguments,2);return d.map(a,function(a){return(d.isFunction(f)?f||a:a[f]).apply(a,b)})};d.pluck=function(a,f){return d.map(a,function(a){return a[f]})};
d.max=function(a,f,b){if(!f&&d.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!f&&d.isEmpty(a))return-Infinity;var j={computed:-Infinity};k(a,function(a,d,n){d=f?f.call(b,a,d,n):a;d>=j.computed&&(j={value:a,computed:d})});return j.value};d.min=function(a,f,b){if(!f&&d.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!f&&d.isEmpty(a))return Infinity;var j={computed:Infinity};k(a,function(a,d,n){d=f?f.call(b,a,d,n):a;d<j.computed&&(j={value:a,computed:d})});return j.value};d.shuffle=
function(a){var f=[],d;k(a,function(a,b){d=Math.floor(Math.random()*(b+1));f[b]=f[d];f[d]=a});return f};d.sortBy=function(a,f,b){var j=d.isFunction(f)?f:function(a){return a[f]};return d.pluck(d.map(a,function(a,f,d){return{value:a,criteria:j.call(b,a,f,d)}}).sort(function(a,f){var d=a.criteria,b=f.criteria;return void 0===d?1:void 0===b?-1:d<b?-1:d>b?1:0}),"value")};d.groupBy=function(a,f){var b={},j=d.isFunction(f)?f:function(a){return a[f]};k(a,function(a,f){var d=j(a,f);(b[d]||(b[d]=[])).push(a)});
return b};d.sortedIndex=function(a,f,b){b||(b=d.identity);for(var j=0,c=a.length;j<c;){var e=j+c>>1;b(a[e])<b(f)?j=e+1:c=e}return j};d.toArray=function(a){return!a?[]:d.isArray(a)||d.isArguments(a)?h.call(a):a.toArray&&d.isFunction(a.toArray)?a.toArray():d.values(a)};d.size=function(a){return d.isArray(a)?a.length:d.keys(a).length};d.first=d.head=d.take=function(a,f,d){return null!=f&&!d?h.call(a,0,f):a[0]};d.initial=function(a,f,d){return h.call(a,0,a.length-(null==f||d?1:f))};d.last=function(a,
f,d){return null!=f&&!d?h.call(a,Math.max(a.length-f,0)):a[a.length-1]};d.rest=d.tail=function(a,f,d){return h.call(a,null==f||d?1:f)};d.compact=function(a){return d.filter(a,function(a){return!!a})};d.flatten=function(a,f){return d.reduce(a,function(a,b){if(d.isArray(b))return a.concat(f?b:d.flatten(b));a[a.length]=b;return a},[])};d.without=function(a){return d.difference(a,h.call(arguments,1))};d.uniq=d.unique=function(a,f,b){var b=b?d.map(a,b):a,j=[];3>a.length&&(f=!0);d.reduce(b,function(b,c,
e){if(f?d.last(b)!==c||!b.length:!d.include(b,c))b.push(c),j.push(a[e]);return b},[]);return j};d.union=function(){return d.uniq(d.flatten(arguments,!0))};d.intersection=d.intersect=function(a){var f=h.call(arguments,1);return d.filter(d.uniq(a),function(a){return d.every(f,function(f){return 0<=d.indexOf(f,a)})})};d.difference=function(a){var f=d.flatten(h.call(arguments,1),!0);return d.filter(a,function(a){return!d.include(f,a)})};d.zip=function(){for(var a=h.call(arguments),f=d.max(d.pluck(a,"length")),
b=Array(f),j=0;j<f;j++)b[j]=d.pluck(a,""+j);return b};d.indexOf=function(a,f,b){if(null==a)return-1;var j;if(b)return b=d.sortedIndex(a,f),a[b]===f?b:-1;if(s&&a.indexOf===s)return a.indexOf(f);b=0;for(j=a.length;b<j;b++)if(b in a&&a[b]===f)return b;return-1};d.lastIndexOf=function(a,f){if(null==a)return-1;if(y&&a.lastIndexOf===y)return a.lastIndexOf(f);for(var d=a.length;d--;)if(d in a&&a[d]===f)return d;return-1};d.range=function(a,f,d){1>=arguments.length&&(f=a||0,a=0);for(var d=arguments[2]||1,
b=Math.max(Math.ceil((f-a)/d),0),j=0,c=Array(b);j<b;)c[j++]=a,a+=d;return c};var E=function(){};d.bind=function(a,f){var b,j;if(a.bind===C&&C)return C.apply(a,h.call(arguments,1));if(!d.isFunction(a))throw new TypeError;j=h.call(arguments,2);return b=function(){if(!(this instanceof b))return a.apply(f,j.concat(h.call(arguments)));E.prototype=a.prototype;var d=new E,c=a.apply(d,j.concat(h.call(arguments)));return Object(c)===c?c:d}};d.bindAll=function(a){var f=h.call(arguments,1);0==f.length&&(f=d.functions(a));
k(f,function(f){a[f]=d.bind(a[f],a)});return a};d.memoize=function(a,f){var b={};f||(f=d.identity);return function(){var j=f.apply(this,arguments);return d.has(b,j)?b[j]:b[j]=a.apply(this,arguments)}};d.delay=function(a,f){var d=h.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},f)};d.defer=function(a){return d.delay.apply(d,[a,1].concat(h.call(arguments,1)))};d.throttle=function(a,f){var b,j,c,e,g,u,h=d.debounce(function(){g=e=!1},f);return function(){b=this;j=arguments;c||
(c=setTimeout(function(){c=null;g&&a.apply(b,j);h()},f));e?g=!0:u=a.apply(b,j);h();e=!0;return u}};d.debounce=function(a,f,d){var b;return function(){var j=this,c=arguments;d&&!b&&a.apply(j,c);clearTimeout(b);b=setTimeout(function(){b=null;d||a.apply(j,c)},f)}};d.once=function(a){var f=!1,d;return function(){if(f)return d;f=!0;return d=a.apply(this,arguments)}};d.wrap=function(a,f){return function(){var d=[a].concat(h.call(arguments,0));return f.apply(this,d)}};d.compose=function(){var a=arguments;
return function(){for(var f=arguments,d=a.length-1;0<=d;d--)f=[a[d].apply(this,f)];return f[0]}};d.after=function(a,f){return 0>=a?f():function(){if(1>--a)return f.apply(this,arguments)}};d.keys=x||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var f=[],b;for(b in a)d.has(a,b)&&(f[f.length]=b);return f};d.values=function(a){return d.map(a,d.identity)};d.functions=d.methods=function(a){var f=[],b;for(b in a)d.isFunction(a[b])&&f.push(b);return f.sort()};d.extend=function(a){k(h.call(arguments,
1),function(f){for(var d in f)a[d]=f[d]});return a};d.pick=function(a){var f={};k(d.flatten(h.call(arguments,1)),function(d){d in a&&(f[d]=a[d])});return f};d.defaults=function(a){k(h.call(arguments,1),function(f){for(var d in f)null==a[d]&&(a[d]=f[d])});return a};d.clone=function(a){return!d.isObject(a)?a:d.isArray(a)?a.slice():d.extend({},a)};d.tap=function(a,f){f(a);return a};d.isEqual=function(a,f){return b(a,f,[])};d.isEmpty=function(a){if(null==a)return!0;if(d.isArray(a)||d.isString(a))return 0===
a.length;for(var f in a)if(d.has(a,f))return!1;return!0};d.isElement=function(a){return!!(a&&1==a.nodeType)};d.isArray=g||function(a){return"[object Array]"==m.call(a)};d.isObject=function(a){return a===Object(a)};d.isArguments=function(a){return"[object Arguments]"==m.call(a)};d.isArguments(arguments)||(d.isArguments=function(a){return!(!a||!d.has(a,"callee"))});d.isFunction=function(a){return"[object Function]"==m.call(a)};d.isString=function(a){return"[object String]"==m.call(a)};d.isNumber=function(a){return"[object Number]"==
m.call(a)};d.isFinite=function(a){return d.isNumber(a)&&isFinite(a)};d.isNaN=function(a){return a!==a};d.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==m.call(a)};d.isDate=function(a){return"[object Date]"==m.call(a)};d.isRegExp=function(a){return"[object RegExp]"==m.call(a)};d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.has=function(a,f){return t.call(a,f)};d.noConflict=function(){i._=a;return this};d.identity=function(a){return a};d.times=
function(a,f,d){for(var b=0;b<a;b++)f.call(d,b)};d.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.result=function(a,f){if(null==a)return null;var b=a[f];return d.isFunction(b)?b.call(a):b};d.mixin=function(a){k(d.functions(a),function(f){var b=d[f]=a[f];D.prototype[f]=function(){var a=h.call(arguments);p.call(a,this._wrapped);return F(b.apply(d,a),this._chain)}})};var f=0;d.uniqueId=
function(a){var d=f++;return a?a+d:d};d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/.^/,u={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},G;for(G in u)u[u[G]]=G;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(J,function(a,f){return u[f]})};d.template=function(a,f,b){b=d.defaults(b||{},d.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+u[a]}).replace(b.escape||
j,function(a,f){return"'+\n_.escape("+H(f)+")+\n'"}).replace(b.interpolate||j,function(a,f){return"'+\n("+H(f)+")+\n'"}).replace(b.evaluate||j,function(a,f){return"';\n"+H(f)+"\n;__p+='"})+"';\n";b.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",c=new Function(b.variable||"obj","_",a);if(f)return c(f,d);f=function(a){return c.call(this,a,d)};f.source="function("+(b.variable||"obj")+"){\n"+a+"}";return f};
d.chain=function(a){return d(a).chain()};var D=function(a){this._wrapped=a};d.prototype=D.prototype;var F=function(a,f){return f?d(a).chain():a};d.mixin(d);k("pop push reverse shift sort splice unshift".split(" "),function(a){var f=c[a];D.prototype[a]=function(){var d=this._wrapped;f.apply(d,arguments);var b=d.length;("shift"==a||"splice"==a)&&0===b&&delete d[0];return F(d,this._chain)}});k(["concat","join","slice"],function(a){var f=c[a];D.prototype[a]=function(){return F(f.apply(this._wrapped,arguments),
this._chain)}});D.prototype.chain=function(){this._chain=!0;return this};D.prototype.value=function(){return this._wrapped}}).call(this);
(function(){var b=this,i=b.Backbone,a=Array.prototype.slice,e=Array.prototype.splice,c;c="undefined"!==typeof exports?exports:b.Backbone={};c.VERSION="0.9.2";var g=b._;!g&&"undefined"!==typeof require&&(g=require("underscore"));var h=b.jQuery||b.Zepto||b.ender;c.setDomLibrary=function(a){h=a};c.noConflict=function(){b.Backbone=i;return this};c.emulateHTTP=!1;c.emulateJSON=!1;var p=/\s+/,m=c.Events={on:function(a,d,b){var c,e,g,h,l;if(!d)return this;a=a.split(p);for(c=this._callbacks||(this._callbacks=
{});e=a.shift();)g=(l=c[e])?l.tail:{},g.next=h={},g.context=b,g.callback=d,c[e]={tail:h,next:l?l.next:g};return this},off:function(a,d,b){var c,e,h,l,k,i;if(e=this._callbacks){if(!a&&!d&&!b)return delete this._callbacks,this;for(a=a?a.split(p):g.keys(e);c=a.shift();)if(h=e[c],delete e[c],h&&(d||b))for(l=h.tail;(h=h.next)!==l;)if(k=h.callback,i=h.context,d&&k!==d||b&&i!==b)this.on(c,k,i);return this}},trigger:function(f){var d,b,c,e,g,h;if(!(c=this._callbacks))return this;g=c.all;f=f.split(p);for(h=
a.call(arguments,1);d=f.shift();){if(b=c[d])for(e=b.tail;(b=b.next)!==e;)b.callback.apply(b.context||this,h);if(b=g){e=b.tail;for(d=[d].concat(h);(b=b.next)!==e;)b.callback.apply(b.context||this,d)}}return this}};m.bind=m.on;m.unbind=m.off;var t=c.Model=function(a,d){var b;a||(a={});d&&d.parse&&(a=this.parse(a));if(b=A(this,"defaults"))a=g.extend({},b,a);d&&d.collection&&(this.collection=d.collection);this.attributes={};this._escapedAttributes={};this.cid=g.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=g.clone(this.attributes);this.initialize.apply(this,arguments)};g.extend(t.prototype,m,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return g.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var d;if(d=this._escapedAttributes[a])return d;d=this.get(a);return this._escapedAttributes[a]=g.escape(null==
d?"":""+d)},has:function(a){return null!=this.get(a)},set:function(a,d,b){var c,e;g.isObject(a)||null==a?(c=a,b=d):(c={},c[a]=d);b||(b={});if(!c)return this;c instanceof t&&(c=c.attributes);if(b.unset)for(e in c)c[e]=void 0;if(!this._validate(c,b))return!1;this.idAttribute in c&&(this.id=c[this.idAttribute]);var d=b.changes={},h=this.attributes,l=this._escapedAttributes,k=this._previousAttributes||{};for(e in c){a=c[e];if(!g.isEqual(h[e],a)||b.unset&&g.has(h,e))delete l[e],(b.silent?this._silent:
d)[e]=!0;b.unset?delete h[e]:h[e]=a;!g.isEqual(k[e],a)||g.has(h,e)!=g.has(k,e)?(this.changed[e]=a,b.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}b.silent||this.change(b);return this},unset:function(a,d){(d||(d={})).unset=!0;return this.set(a,null,d)},clear:function(a){(a||(a={})).unset=!0;return this.set(g.clone(this.attributes),a)},fetch:function(a){var a=a?g.clone(a):{},d=this,b=a.success;a.success=function(c,e,g){if(!d.set(d.parse(c,g),a))return!1;b&&b(d,c)};
a.error=c.wrapError(a.error,d,a);return(this.sync||c.sync).call(this,"read",this,a)},save:function(a,d,b){var e,h;g.isObject(a)||null==a?(e=a,b=d):(e={},e[a]=d);b=b?g.clone(b):{};if(b.wait){if(!this._validate(e,b))return!1;h=g.clone(this.attributes)}a=g.extend({},b,{silent:!0});if(e&&!this.set(e,b.wait?a:b))return!1;var l=this,k=b.success;b.success=function(a,f,d){f=l.parse(a,d);b.wait&&(delete b.wait,f=g.extend(e||{},f));if(!l.set(f,b))return!1;k?k(l,a):l.trigger("sync",l,a,b)};b.error=c.wrapError(b.error,
l,b);d=this.isNew()?"create":"update";d=(this.sync||c.sync).call(this,d,this,b);b.wait&&this.set(h,a);return d},destroy:function(a){var a=a?g.clone(a):{},d=this,b=a.success,e=function(){d.trigger("destroy",d,d.collection,a)};if(this.isNew())return e(),!1;a.success=function(c){a.wait&&e();b?b(d,c):d.trigger("sync",d,c,a)};a.error=c.wrapError(a.error,d,a);var h=(this.sync||c.sync).call(this,"delete",this,a);a.wait||e();return h},url:function(){var a=A(this,"urlRoot")||A(this.collection,"url")||E();
return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var d=this._changing;this._changing=!0;for(var b in this._silent)this._pending[b]=!0;var c=g.extend({},a.changes,this._silent);this._silent={};for(b in c)this.trigger("change:"+b,this,this.get(b),a);if(d)return this;for(;!g.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(b in this.changed)!this._pending[b]&&!this._silent[b]&&delete this.changed[b];this._previousAttributes=g.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!g.isEmpty(this.changed):g.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?g.clone(this.changed):!1;var b,d=!1,c=this._previousAttributes,e;for(e in a)if(!g.isEqual(c[e],b=a[e]))(d||(d={}))[e]=b;return d},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return g.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=g.extend({},this.attributes,a),d=this.validate(a,b);if(!d)return!0;b&&b.error?b.error(this,d,b):this.trigger("error",this,d,b);return!1}});var q=c.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};g.extend(q.prototype,m,{model:t,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var d,c,h,l,k,i={},s={},p=[];b||(b={});a=g.isArray(a)?a.slice():[a];d=0;for(c=a.length;d<c;d++){if(!(h=a[d]=this._prepareModel(a[d],b)))throw Error("Can't add an invalid model to a collection");l=h.cid;k=h.id;i[l]||this._byCid[l]||null!=k&&(s[k]||this._byId[k])?
p.push(d):i[l]=s[k]=h}for(d=p.length;d--;)a.splice(p[d],1);d=0;for(c=a.length;d<c;d++)(h=a[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,null!=h.id&&(this._byId[h.id]=h);this.length+=c;e.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;d=0;for(c=this.models.length;d<c;d++)if(i[(h=this.models[d]).cid])b.index=d,h.trigger("add",h,this,b);return this},remove:function(a,b){var d,c,e,h;b||(b={});a=g.isArray(a)?
a.slice():[a];d=0;for(c=a.length;d<c;d++)if(h=this.getByCid(a[d])||this.get(a[d]))delete this._byId[h.id],delete this._byCid[h.cid],e=this.indexOf(h),this.models.splice(e,1),this.length--,b.silent||(b.index=e,h.trigger("remove",h,this,b)),this._removeReference(h);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,g.extend({at:0},b));return a},
shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return g.isEmpty(a)?[]:this.filter(function(b){for(var d in a)if(a[d]!==b.get(d))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=g.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return g.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var d=0,c=this.models.length;d<c;d++)this._removeReference(this.models[d]);this._reset();this.add(a,g.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?g.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,d=a.success;a.success=function(c,
e,g){b[a.add?"add":"reset"](b.parse(c,g),a);d&&d(b,c)};a.error=c.wrapError(a.error,b,a);return(this.sync||c.sync).call(this,"read",this,a)},create:function(a,b){var d=this,b=b?g.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||d.add(a,b);var c=b.success;b.success=function(e,g){b.wait&&d.add(e,b);c?c(e,g):e.trigger("sync",a,g,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return g(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof t?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,d,c){("add"==a||"remove"==a)&&d!=this||("destroy"==a&&this.remove(b,c),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
arguments))}});g.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first initial rest last without indexOf shuffle lastIndexOf isEmpty groupBy".split(" "),function(a){q.prototype[a]=function(){return g[a].apply(g,[this.models].concat(g.toArray(arguments)))}});var v=c.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},w=/:\w+/g,
z=/\*\w+/g,B=/[-[\]{}()+?.,\\^$|#\s]/g;g.extend(v.prototype,m,{initialize:function(){},route:function(a,b,d){c.history||(c.history=new r);g.isRegExp(a)||(a=this._routeToRegExp(a));d||(d=this[b]);c.history.route(a,g.bind(function(e){e=this._extractParameters(a,e);d&&d.apply(this,e);this.trigger.apply(this,["route:"+b].concat(e));c.history.trigger("route",this,b,e)},this));return this},navigate:function(a,b){c.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,
this.routes[b]]);b=0;for(var d=a.length;b<d;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(B,"\\$&").replace(w,"([^/]+)").replace(z,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var r=c.History=function(){this.handlers=[];g.bindAll(this,"checkUrl")},l=/^[#\/]/,s=/msie [\w.]+/;r.started=!1;g.extend(r.prototype,m,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:
""},getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,d=window.location.search;d&&(a+=d)}else a=this.getHash();a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(l,"")},start:function(a){if(r.started)throw Error("Backbone.history has already been started");r.started=!0;this.options=g.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=s.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?h(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?h(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&(this._hasPushState&&b&&a.hash)&&(this.fragment=this.getHash().replace(l,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);r.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return g.any(this.handlers,
function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!r.started)return!1;if(!b||!0===b)b={trigger:b};var d=(a||"").replace(l,"");this.fragment!=d&&(this._hasPushState?(0!=d.indexOf(this.options.root)&&(d=this.options.root+d),this.fragment=d,window.history[b.replace?"replaceState":"pushState"]({},document.title,d)):this._wantsHashChange?(this.fragment=d,this._updateHash(window.location,d,b.replace),this.iframe&&d!=this.getFragment(this.getHash(this.iframe))&&(b.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,d,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,d){d?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var y=c.View=function(a){this.cid=g.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},x=/^(\S+)\s*(.*)$/,C="model collection el id attributes className tagName".split(" ");
g.extend(y.prototype,m,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,d){a=document.createElement(a);b&&h(a).attr(b);d&&h(a).html(d);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof h?a:h(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=A(this,"events"))){this.undelegateEvents();
for(var b in a){var d=a[b];g.isFunction(d)||(d=this[a[b]]);if(!d)throw Error('Method "'+a[b]+'" does not exist');var c=b.match(x),e=c[1],c=c[2],d=g.bind(d,this),e=e+(".delegateEvents"+this.cid);""===c?this.$el.bind(e,d):this.$el.delegate(c,e,d)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=g.extend({},this.options,a));for(var b=0,d=C.length;b<d;b++){var c=C[b];a[c]&&(this[c]=a[c])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=A(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});t.extend=q.extend=v.extend=y.extend=function(a,b){var d=this,c;c=a&&a.hasOwnProperty("constructor")?a.constructor:function(){d.apply(this,arguments)};g.extend(c,d);k.prototype=d.prototype;c.prototype=new k;a&&g.extend(c.prototype,a);b&&g.extend(c,b);c.prototype.constructor=c;c.__super__=d.prototype;c.extend=this.extend;return c};var d={create:"POST",
update:"PUT","delete":"DELETE",read:"GET"};c.sync=function(a,b,e){var l=d[a];e||(e={});var k={type:l,dataType:"json"};e.url||(k.url=A(b,"url")||E());if(!e.data&&b&&("create"==a||"update"==a))k.contentType="application/json",k.data=JSON.stringify(b.toJSON());c.emulateJSON&&(k.contentType="application/x-www-form-urlencoded",k.data=k.data?{model:k.data}:{});if(c.emulateHTTP&&("PUT"===l||"DELETE"===l))c.emulateJSON&&(k.data._method=l),k.type="POST",k.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
l)};"GET"!==k.type&&!c.emulateJSON&&(k.processData=!1);return h.ajax(g.extend(k,e))};c.wrapError=function(a,b,d){return function(c,e){e=c===b?e:c;a?a(b,e,d):b.trigger("error",b,e,d)}};var k=function(){},A=function(a,b){return!a||!a[b]?null:g.isFunction(a[b])?a[b]():a[b]},E=function(){throw Error('A "url" property or function must be specified');}}).call(this);
!function(b){b(function(){var i=b.support,a;a:{a=document.createElement("bootstrap");var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in e)if(void 0!==a.style[c]){a=e[c];break a}a=void 0}i.transition=a&&{end:a}})}(window.jQuery);
!function(b){var i=function(a){b(a).on("click",'[data-dismiss="alert"]',this.close)};i.prototype.close=function(a){function e(){h.trigger("closed").remove()}var c=b(this),g=c.attr("data-target"),h;g||(g=(g=c.attr("href"))&&g.replace(/.*(?=#[^\s]*$)/,""));h=b(g);a&&a.preventDefault();h.length||(h=c.hasClass("alert")?c:c.parent());h.trigger(a=b.Event("close"));a.isDefaultPrevented()||(h.removeClass("in"),b.support.transition&&h.hasClass("fade")?h.on(b.support.transition.end,e):e())};b.fn.alert=function(a){return this.each(function(){var e=
b(this),c=e.data("alert");c||e.data("alert",c=new i(this));"string"==typeof a&&c[a].call(e)})};b.fn.alert.Constructor=i;b(function(){b("body").on("click.alert.data-api",'[data-dismiss="alert"]',i.prototype.close)})}(window.jQuery);
!function(b){var i=function(a,e){this.$element=b(a);this.options=b.extend({},b.fn.button.defaults,e)};i.prototype.setState=function(a){var b=this.$element,c=b.data(),g=b.is("input")?"val":"html",a=a+"Text";c.resetText||b.data("resetText",b[g]());b[g](c[a]||this.options[a]);setTimeout(function(){"loadingText"==a?b.addClass("disabled").attr("disabled","disabled"):b.removeClass("disabled").removeAttr("disabled")},0)};i.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons-radio"]');
a&&a.find(".active").removeClass("active");this.$element.toggleClass("active")};b.fn.button=function(a){return this.each(function(){var e=b(this),c=e.data("button"),g="object"==typeof a&&a;c||e.data("button",c=new i(this,g));"toggle"==a?c.toggle():a&&c.setState(a)})};b.fn.button.defaults={loadingText:"loading..."};b.fn.button.Constructor=i;b(function(){b("body").on("click.button.data-api","[data-toggle^=button]",function(a){a=b(a.target);a.hasClass("btn")||(a=a.closest(".btn"));a.button("toggle")})})}(window.jQuery);
!function(b){var i=function(a,e){this.$element=b(a);this.options=e;this.options.slide&&this.slide(this.options.slide);"hover"==this.options.pause&&this.$element.on("mouseenter",b.proxy(this.pause,this)).on("mouseleave",b.proxy(this.cycle,this))};i.prototype={cycle:function(a){a||(this.paused=!1);this.options.interval&&!this.paused&&(this.interval=setInterval(b.proxy(this.next,this),this.options.interval));return this},to:function(a){var e=this.$element.find(".item.active"),c=e.parent().children(),
e=c.index(e),g=this;if(!(a>c.length-1||0>a))return this.sliding?this.$element.one("slid",function(){g.to(a)}):e==a?this.pause().cycle():this.slide(a>e?"next":"prev",b(c[a]))},pause:function(a){a||(this.paused=!0);this.$element.find(".next, .prev").length&&b.support.transition.end&&(this.$element.trigger(b.support.transition.end),this.cycle());clearInterval(this.interval);this.interval=null;return this},next:function(){if(!this.sliding)return this.slide("next")},prev:function(){if(!this.sliding)return this.slide("prev")},
slide:function(a,e){var c=this.$element.find(".item.active"),g=e||c[a](),h=this.interval,i="next"==a?"left":"right",m="next"==a?"first":"last",t=this,q=b.Event("slide",{relatedTarget:g[0]});this.sliding=!0;h&&this.pause();g=g.length?g:this.$element.find(".item")[m]();if(!g.hasClass("active")){if(b.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(q);if(q.isDefaultPrevented())return;g.addClass(a);g[0].offsetWidth;c.addClass(i);g.addClass(i);this.$element.one(b.support.transition.end,
function(){g.removeClass([a,i].join(" ")).addClass("active");c.removeClass(["active",i].join(" "));t.sliding=!1;setTimeout(function(){t.$element.trigger("slid")},0)})}else{this.$element.trigger(q);if(q.isDefaultPrevented())return;c.removeClass("active");g.addClass("active");this.sliding=!1;this.$element.trigger("slid")}h&&this.cycle();return this}}};b.fn.carousel=function(a){return this.each(function(){var e=b(this),c=e.data("carousel"),g=b.extend({},b.fn.carousel.defaults,"object"==typeof a&&a),
h="string"==typeof a?a:g.slide;c||e.data("carousel",c=new i(this,g));if("number"==typeof a)c.to(a);else if(h)c[h]();else g.interval&&c.cycle()})};b.fn.carousel.defaults={interval:5E3,pause:"hover"};b.fn.carousel.Constructor=i;b(function(){b("body").on("click.carousel.data-api","[data-slide]",function(a){var e=b(this),c,g=b(e.attr("data-target")||(c=e.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),e=!g.data("modal")&&b.extend({},g.data(),e.data());g.carousel(e);a.preventDefault()})})}(window.jQuery);
!function(b){var i=function(a,e){this.$element=b(a);this.options=b.extend({},b.fn.collapse.defaults,e);this.options.parent&&(this.$parent=b(this.options.parent));this.options.toggle&&this.toggle()};i.prototype={constructor:i,dimension:function(){return this.$element.hasClass("width")?"width":"height"},show:function(){var a,e,c,g;if(!this.transitioning){a=this.dimension();e=b.camelCase(["scroll",a].join("-"));if((c=this.$parent&&this.$parent.find("> .accordion-group > .in"))&&c.length){if((g=c.data("collapse"))&&
g.transitioning)return;c.collapse("hide");g||c.data("collapse",null)}this.$element[a](0);this.transition("addClass",b.Event("show"),"shown");b.support.transition&&this.$element[a](this.$element[0][e])}},hide:function(){var a;this.transitioning||(a=this.dimension(),this.reset(this.$element[a]()),this.transition("removeClass",b.Event("hide"),"hidden"),this.$element[a](0))},reset:function(a){var b=this.dimension();this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth;this.$element[null!==
a?"addClass":"removeClass"]("collapse");return this},transition:function(a,e,c){var g=this,h=function(){"show"==e.type&&g.reset();g.transitioning=0;g.$element.trigger(c)};this.$element.trigger(e);e.isDefaultPrevented()||(this.transitioning=1,this.$element[a]("in"),b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,h):h())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};b.fn.collapse=function(a){return this.each(function(){var e=
b(this),c=e.data("collapse"),g="object"==typeof a&&a;c||e.data("collapse",c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.collapse.defaults={toggle:!0};b.fn.collapse.Constructor=i;b(function(){b("body").on("click.collapse.data-api","[data-toggle=collapse]",function(a){var e=b(this),c,a=e.attr("data-target")||a.preventDefault()||(c=e.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");c=b(a).data("collapse")?"toggle":e.data();e[b(a).hasClass("in")?"addClass":"removeClass"]("collapsed");b(a).collapse(c)})})}(window.jQuery);
!function(b){function i(){a(b(e)).removeClass("open")}function a(a){var c=a.attr("data-target");c||(c=(c=a.attr("href"))&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));c=b(c);c.length||(c=a.parent());return c}var e="[data-toggle=dropdown]",c=function(a){var c=b(a).on("click.dropdown.data-api",this.toggle);b("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};c.prototype={constructor:c,toggle:function(){var c=b(this),e,p;if(!c.is(".disabled, :disabled"))return e=a(c),p=
e.hasClass("open"),i(),p||(e.toggleClass("open"),c.focus()),!1},keydown:function(c){var e,i,m;if(/(38|40|27)/.test(c.keyCode)&&(e=b(this),c.preventDefault(),c.stopPropagation(),!e.is(".disabled, :disabled"))){i=a(e);m=i.hasClass("open");if(!m||m&&27==c.keyCode)return e.click();e=b("[role=menu] li:not(.divider) a",i);e.length&&(i=e.index(e.filter(":focus")),38==c.keyCode&&0<i&&i--,40==c.keyCode&&i<e.length-1&&i++,~i||(i=0),e.eq(i).focus())}}};b.fn.dropdown=function(a){return this.each(function(){var e=
b(this),i=e.data("dropdown");i||e.data("dropdown",i=new c(this));"string"==typeof a&&i[a].call(e)})};b.fn.dropdown.Constructor=c;b(function(){b("html").on("click.dropdown.data-api touchstart.dropdown.data-api",i);b("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",e,c.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",e+", [role=menu]",c.prototype.keydown)})}(window.jQuery);
!function(b){var i=function(a,e){this.options=e;this.$element=b(a).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};i.prototype={constructor:i,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var a=this,e=b.Event("show");this.$element.trigger(e);!this.isShown&&!e.isDefaultPrevented()&&(b("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var c=
b.support.transition&&a.$element.hasClass("fade");a.$element.parent().length||a.$element.appendTo(document.body);a.$element.show();c&&a.$element[0].offsetWidth;a.$element.addClass("in").attr("aria-hidden",!1).focus();a.enforceFocus();c?a.$element.one(b.support.transition.end,function(){a.$element.trigger("shown")}):a.$element.trigger("shown")}))},hide:function(a){a&&a.preventDefault();a=b.Event("hide");this.$element.trigger(a);this.isShown&&!a.isDefaultPrevented()&&(this.isShown=!1,b("body").removeClass("modal-open"),
this.escape(),b(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var a=this;b(document).on("focusin.modal",function(b){a.$element[0]!==b.target&&!a.$element.has(b.target).length&&a.$element.focus()})},escape:function(){var a=this;if(this.isShown&&this.options.keyboard)this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()});
else this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var a=this,e=setTimeout(function(){a.$element.off(b.support.transition.end);a.hideModal()},500);this.$element.one(b.support.transition.end,function(){clearTimeout(e);a.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(a){var e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&
this.options.backdrop){var c=b.support.transition&&e;this.$backdrop=b('<div class="modal-backdrop '+e+'" />').appendTo(document.body);"static"!=this.options.backdrop&&this.$backdrop.click(b.proxy(this.hide,this));c&&this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");c?this.$backdrop.one(b.support.transition.end,a):a()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),b.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(b.support.transition.end,b.proxy(this.removeBackdrop,
this)):this.removeBackdrop()):a&&a()}};b.fn.modal=function(a){return this.each(function(){var e=b(this),c=e.data("modal"),g=b.extend({},b.fn.modal.defaults,e.data(),"object"==typeof a&&a);c||e.data("modal",c=new i(this,g));if("string"==typeof a)c[a]();else g.show&&c.show()})};b.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0};b.fn.modal.Constructor=i;b(function(){b("body").on("click.modal.data-api",'[data-toggle="modal"]',function(a){var e=b(this),c=e.attr("href"),g=b(e.attr("data-target")||c&&
c.replace(/.*(?=#[^\s]+$)/,"")),c=g.data("modal")?"toggle":b.extend({remote:!/#/.test(c)&&c},g.data(),e.data());a.preventDefault();g.modal(c).one("hide",function(){e.focus()})})})}(window.jQuery);
!function(b){var i=function(a,b){this.init("tooltip",a,b)};i.prototype={constructor:i,init:function(a,e,c){this.type=a;this.$element=b(e);this.options=this.getOptions(c);this.enabled=!0;if("click"==this.options.trigger)this.$element.on("click."+this.type,this.options.selector,b.proxy(this.toggle,this));else"manual"!=this.options.trigger&&(a="hover"==this.options.trigger?"mouseenter":"focus",e="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(a+"."+this.type,this.options.selector,
b.proxy(this.enter,this)),this.$element.on(e+"."+this.type,this.options.selector,b.proxy(this.leave,this)));this.options.selector?this._options=b.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(a){a=b.extend({},b.fn[this.type].defaults,a,this.$element.data());a.delay&&"number"==typeof a.delay&&(a.delay={show:a.delay,hide:a.delay});return a},enter:function(a){var e=b(a.currentTarget)[this.type](this._options).data(this.type);if(!e.options.delay||!e.options.delay.show)return e.show();
clearTimeout(this.timeout);e.hoverState="in";this.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)},leave:function(a){var e=b(a.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!e.options.delay||!e.options.delay.hide)return e.hide();e.hoverState="out";this.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)},show:function(){var a,b,c,g,h,i,m;if(this.hasContent()&&this.enabled){a=this.tip();
this.setContent();this.options.animation&&a.addClass("fade");i="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement;b=/in/.test(i);a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body);c=this.getPosition(b);g=a[0].offsetWidth;h=a[0].offsetHeight;switch(b?i.split(" ")[1]:i){case "bottom":m={top:c.top+c.height,left:c.left+c.width/2-g/2};break;case "top":m={top:c.top-h,left:c.left+c.width/2-g/2};break;
case "left":m={top:c.top+c.height/2-h/2,left:c.left-g};break;case "right":m={top:c.top+c.height/2-h/2,left:c.left+c.width}}a.css(m).addClass(i).addClass("in")}},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b);a.removeClass("fade in top bottom left right")},hide:function(){var a=this.tip();a.removeClass("in");if(b.support.transition&&this.$tip.hasClass("fade")){var e=setTimeout(function(){a.off(b.support.transition.end).remove()},
500);a.one(b.support.transition.end,function(){clearTimeout(e);a.remove()})}else a.remove();return this},fixTitle:function(){var a=this.$element;if(a.attr("title")||"string"!=typeof a.attr("data-original-title"))a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(a){return b.extend({},a?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a=
this.$element,b=this.options;return a.attr("data-original-title")||("function"==typeof b.title?b.title.call(a[0]):b.title)},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+
this.type).removeData(this.type)}};b.fn.tooltip=function(a){return this.each(function(){var e=b(this),c=e.data("tooltip"),g="object"==typeof a&&a;c||e.data("tooltip",c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.tooltip.Constructor=i;b.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery);
!function(b){var i=function(a,b){this.init("popover",a,b)};i.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:i,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b);a.find(".popover-content > *")[this.options.html?"html":"text"](c);a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a=this.$element,b=this.options;
return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},tip:function(){this.$tip||(this.$tip=b(this.options.template));return this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});b.fn.popover=function(a){return this.each(function(){var e=b(this),c=e.data("popover"),g="object"==typeof a&&a;c||e.data("popover",c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.popover.Constructor=i;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,
{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);
!function(b){function i(a,e){var c=b.proxy(this.process,this),g=b(a).is("body")?b(window):b(a),h;this.options=b.extend({},b.fn.scrollspy.defaults,e);this.$scrollElement=g.on("scroll.scroll-spy.data-api",c);this.selector=(this.options.target||(h=b(a).attr("href"))&&h.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a";this.$body=b("body");this.refresh();this.process()}i.prototype={constructor:i,refresh:function(){var a=this;this.offsets=b([]);this.targets=b([]);this.$body.find(this.selector).map(function(){var a=
b(this),a=a.data("target")||a.attr("href"),c=/^#\w/.test(a)&&b(a);return c&&c.length&&[[c.position().top,a]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){a.offsets.push(this[0]);a.targets.push(this[1])})},process:function(){var a=this.$scrollElement.scrollTop()+this.options.offset,b=(this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight)-this.$scrollElement.height(),c=this.offsets,g=this.targets,h=this.activeTarget,i;if(a>=b)return h!=(i=g.last()[0])&&this.activate(i);for(i=
c.length;i--;)h!=g[i]&&a>=c[i]&&(!c[i+1]||a<=c[i+1])&&this.activate(g[i])},activate:function(a){this.activeTarget=a;b(this.selector).parent(".active").removeClass("active");a=b(this.selector+'[data-target="'+a+'"],'+this.selector+'[href="'+a+'"]').parent("li").addClass("active");a.parent(".dropdown-menu").length&&(a=a.closest("li.dropdown").addClass("active"));a.trigger("activate")}};b.fn.scrollspy=function(a){return this.each(function(){var e=b(this),c=e.data("scrollspy"),g="object"==typeof a&&a;
c||e.data("scrollspy",c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.scrollspy.Constructor=i;b.fn.scrollspy.defaults={offset:10};b(window).on("load",function(){b('[data-spy="scroll"]').each(function(){var a=b(this);a.scrollspy(a.data())})})}(window.jQuery);
!function(b){var i=function(a){this.element=b(a)};i.prototype={constructor:i,show:function(){var a=this.element,e=a.closest("ul:not(.dropdown-menu)"),c=a.attr("data-target"),g,h;c||(c=(c=a.attr("href"))&&c.replace(/.*(?=#[^\s]*$)/,""));a.parent("li").hasClass("active")||(g=e.find(".active a").last()[0],h=b.Event("show",{relatedTarget:g}),a.trigger(h),h.isDefaultPrevented()||(c=b(c),this.activate(a.parent("li"),e),this.activate(c,c.parent(),function(){a.trigger({type:"shown",relatedTarget:g})})))},
activate:function(a,e,c){function g(){h.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");a.addClass("active");i?(a[0].offsetWidth,a.addClass("in")):a.removeClass("fade");a.parent(".dropdown-menu")&&a.closest("li.dropdown").addClass("active");c&&c()}var h=e.find("> .active"),i=c&&b.support.transition&&h.hasClass("fade");i?h.one(b.support.transition.end,g):g();h.removeClass("in")}};b.fn.tab=function(a){return this.each(function(){var e=b(this),c=e.data("tab");c||e.data("tab",
c=new i(this));if("string"==typeof a)c[a]()})};b.fn.tab.Constructor=i;b(function(){b("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(a){a.preventDefault();b(this).tab("show")})})}(window.jQuery);
!function(b){var i=function(a,e){this.$element=b(a);this.options=b.extend({},b.fn.typeahead.defaults,e);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=b(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=!1;this.listen()};i.prototype={constructor:i,select:function(){var a=this.$menu.find(".active").attr("data-value");
this.$element.val(this.updater(a)).change();return this.hide()},updater:function(a){return a},show:function(){var a=b.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:a.top+a.height,left:a.left});this.$menu.show();this.shown=!0;return this},hide:function(){this.$menu.hide();this.shown=!1;return this},lookup:function(){var a;this.query=this.$element.val();return!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(a=b.isFunction(this.source)?
this.source(this.query,b.proxy(this.process,this)):this.source)?this.process(a):this},process:function(a){var e=this,a=b.grep(a,function(a){return e.matcher(a)}),a=this.sorter(a);return!a.length?this.shown?this.hide():this:this.render(a.slice(0,this.options.items)).show()},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b=[],c=[],g=[],h;h=a.shift();)h.toLowerCase().indexOf(this.query.toLowerCase())?~h.indexOf(this.query)?c.push(h):g.push(h):
b.push(h);return b.concat(c,g)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(a){var e=this,a=b(a).map(function(a,g){a=b(e.options.item).attr("data-value",g);a.find("a").html(e.highlighter(g));return a[0]});a.first().addClass("active");this.$menu.html(a);return this},next:function(){var a=this.$menu.find(".active").removeClass("active").next();a.length||
(a=b(this.$menu.find("li")[0]));a.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active").prev();a.length||(a=this.$menu.find("li").last());a.addClass("active")},listen:function(){this.$element.on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this));if(b.browser.chrome||b.browser.webkit||b.browser.msie)this.$element.on("keydown",b.proxy(this.keydown,this));this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter",
"li",b.proxy(this.mouseenter,this))},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault();this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(a){this.suppressKeyPressRepeat=!~b.inArray(a.keyCode,[40,38,9,13,27]);this.move(a)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;
this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation();a.preventDefault()},blur:function(){var a=this;setTimeout(function(){a.hide()},150)},click:function(a){a.stopPropagation();a.preventDefault();this.select()},mouseenter:function(a){this.$menu.find(".active").removeClass("active");b(a.currentTarget).addClass("active")}};b.fn.typeahead=function(a){return this.each(function(){var e=b(this),c=e.data("typeahead"),g="object"==typeof a&&a;c||e.data("typeahead",
c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};b.fn.typeahead.Constructor=i;b(function(){b("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(a){var e=b(this);e.data("typeahead")||(a.preventDefault(),e.typeahead(e.data()))})})}(window.jQuery);
!function(b){var i=function(a,e){this.options=b.extend({},b.fn.affix.defaults,e);this.$window=b(window).on("scroll.affix.data-api",b.proxy(this.checkPosition,this));this.$element=b(a);this.checkPosition()};i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var a=b(document).height(),e=this.$window.scrollTop(),c=this.$element.offset(),g=this.options.offset,h=g.bottom,i=g.top;"object"!=typeof g&&(h=i=g);"function"==typeof i&&(i=g.top());"function"==typeof h&&(h=g.bottom());a=null!=
this.unpin&&e+this.unpin<=c.top?!1:null!=h&&c.top+this.$element.height()>=a-h?"bottom":null!=i&&e<=i?"top":!1;this.affixed!==a&&(this.affixed=a,this.unpin="bottom"==a?c.top-e:null,this.$element.removeClass("affix affix-top affix-bottom").addClass("affix"+(a?"-"+a:"")))}};b.fn.affix=function(a){return this.each(function(){var e=b(this),c=e.data("affix"),g="object"==typeof a&&a;c||e.data("affix",c=new i(this,g));if("string"==typeof a)c[a]()})};b.fn.affix.Constructor=i;b.fn.affix.defaults={offset:0};
b(window).on("load",function(){b('[data-spy="affix"]').each(function(){var a=b(this),e=a.data();e.offset=e.offset||{};e.offsetBottom&&(e.offset.bottom=e.offsetBottom);e.offsetTop&&(e.offset.top=e.offsetTop);a.affix(e)})})}(window.jQuery);
var App=function(){function b(){return this}function i(){return arguments.callee.caller.__owner__.__super__}function a(b){var c=Backbone.Model.extend.apply(this,arguments),e;for(e in b)$.isFunction(b[e])&&(b[e].__owner__=c);c.extend=a;return c}function e(a,b){if(b)for(var c in b)a.on(c,b[c])}function c(a,b,c){b.extend&&(a=r[c](b.extend),delete b.extend);return a}function g(a){function b(){clearTimeout(f)}function c(){a.isManualClose||(f=setTimeout(e,3E3))}function e(){w=null;b();g.fadeOut(200,function(){$(this).remove()});
return!1}var f,g=$(B(a)).appendTo($("body")),h=App.getView("Button"),i=a.buttons,l=g.find("._buttons"),s;w&&w.triggerHandler("close");if(i)for(var x=0;x<i.length;x++)"ok"==i[x]?s=new h({type:a.type,text:"OK",click:function(){e();a.callback&&a.callback()}}):"cancel"==i[x]&&(s=new h({text:"\u041e\u0442\u043c\u0435\u043d\u0430",click:function(){e()}})),s&&l.append(s.$el);else l.remove();w=g.css({opacity:0,"margin-top":-10,left:"50%","max-width":g.width(),"margin-left":-g.width()/2}).find(".close").click(e).end().animate({"margin-top":0,
opacity:1},200).on({close:e,mouseenter:b,mouseleave:c});a.modal&&(a.isManualClose=!0,g.click(function(a){a.stopPropagation()}),g=g.wrap('<div class="b-systemmsg-over">').parent().hide().fadeIn(200).click(e));c()}function h(){var a=$(C());$(window).on(this.globalEvents);editor.clearError().$el.appendTo(a);a.appendTo(editor.$el);a.fadeIn(200);editor.fit();this.wrapper=a}function p(){this.editor.trigger("eleditdone",this.el);m.call(this)}function m(){$(window).off(this.globalEvents);var a=this;this.wrapper.fadeOut(200,
function(){a.wrapper.remove()})}_.templateSettings={interpolate:/\{(.+?)\}/g};Backbone.sync=function(a,b,c){"create"==a&&(a="update");"update"==a&&b instanceof l&&(c.params=$.extend(b.attributes||{},c.params));"delete"==a&&b instanceof l&&(c.params={id:b.id});a=App.rpc.request(b.api+"."+a,c.params).on("success",c.success,b).on("error",c.error,b).on("complete",c.complete,b);return b.__sync=a};var t={},q={},v={},w,z=!1,B=_.template('<div class="b-systemmsg"><div class="alert alert-{type} alert-block"><button type="button" class="close" data-dismiss="alert">\u00d7</button><h4 class="alert-heading">{title}</h4><p>{text}</p><p class="_buttons"></p></div></div>'),
r={view:{getScrollbarWidth:function(){var a=arguments.callee;if(!a.width){var b=$('<div style="width:50px;height:50px;overflow:auto;position:absolute;top:-200px;left:-200px;">');$("body").append(b);var c=b.innerWidth(),e=b.append('<div style="height:100px;width:100%;">').find("div").innerWidth();$(b).remove();a.width=c-e}return a.width},setEditor:function(a,b){if(b){var c={el:a,editor:b,globalEvents:{mousedown:function(){p.call(c)},keydown:function(a){if(27==a.keyCode)return m.call(c),!1;if(13==a.keyCode)return p.call(c),
!1}}};a.addClass("edit");a.on("edit",function(){h.call(c)})}else a.removeClass("edit"),a.off("edit")},setLoading:function(a,b){if(a){if(b){a.addClass("state_loading");var c=$('<div class="b-loading"></div>').hide().appendTo(a).fadeIn(200);50>a.height()&&c.css({"border-radius":a.css("border-radius"),"background-color":a.css("background-color")}).addClass("mod_small")}else a.children(".b-loading").fadeOut(200,function(){$(this).remove();a.removeClass("state_loading")});return this}},applyInset:function(a){z&&
!a.is("._inset")&&a.addClass("effect-inset _inset").css({"background-color":a.css("color"),color:"transparent"});return a}},msg:{alert:function(a){g($.extend({type:"error"},a))},warning:function(a){g($.extend({type:"warning"},a))},success:function(a){g($.extend({type:"success"},a))},okcancel:function(a){g($.extend({type:"info",modal:!0,buttons:["ok","cancel"]},a))}},defineView:function(a,b){t[a]=c(s,b,"getView").extend(b)},getView:function(a){return t[a]},defineModel:function(a,b){q[a]=c(l,b,"getModel").extend(b)},
getModel:function(a){return q[a]},defineCollection:function(a,b){v[a]=c(y,b,"getCollection").extend(b)},getCollection:function(a){return v[a]},debounce:function(a,b,c,e){if(!e)return _.debounce.call(_,a,b,c);var f={},g=_.uniqueId("_debounce");return function(){var e=arguments[0]||"null";"string"==typeof e||$.isNumeric(e)?(f[e]||(f[e]=_.debounce.call(_,a,b,c)),e=f[e]):(e[g]||(e[g]=_.debounce.call(_,a,b,c)),e=e[g]);e.apply(this,arguments)}}},l=a.call(Backbone.Model,{initialize:function(){e(this,this.listeners)},
validate:function(a,b){if(this.validateModel){if(b.onlynew)for(var c in a)a[c]==this.attributes[c]&&delete a[c];return this.validateModel(a,b)}return!1},parse:function(a){return a&&a.model?a.model:a},parent:i}),s=a.call(Backbone.View,{initialize:function(a){a||(a={});e(this,a.listeners);this.cid=_.uniqueId();this.init();this.render();this.$el.data("component",this).attr("data-component",this.ctype||!0);this.trigger("init")},init:b,render:function(){this.doRender();this.doPresenter();return this},
doRender:b,doPresenter:b,hide:function(a){if(a)this.$el.hide();else return this.$el.is(":visible")?this.$el.fadeOut(200):this.$el.hide(),this},setLoading:function(a){r.view.setLoading(this.$el,a);return this},show:function(){if(this.$el.is(":visible"))return this;this.$el.fadeIn(200);this._isLayout||this.layout();return this},layout:function(){if(this._isLayout||this.$el.is(":hidden"))return this;this.doLayout();this._isLayout=!0;return this},doLayout:b,parent:i}),y=a.call(Backbone.Collection,{initialize:function(a,
b){e(this,this.listeners);b&&b.params&&(this.params=b.params);this._isLocal=b&&b.local&&!0;this.init();this.model&&(this.api=this.model.prototype.api);this._fetched=!this.api},init:b,getName:function(a){return a.get("name")},fetch:function(a){this._fetched=!0;a||(a={});a.params=$.extend({},this.params,a.params);return y.__super__.fetch.call(this,a)},get:function(a){return y.__super__.get.apply(this,arguments)||y.__super__.getByCid.apply(this,arguments)},add:function(a){for(var b,c=0;c<a.length;c++)(b=
this._byId[a[c].id])&&b.set(a[c]);this.parent().add.apply(this,arguments)},isLocal:function(){return this._isLocal},isFetched:function(){return this._fetched},parse:function(a){return a&&a.data?a.data:a},parent:i}),x=$('<div class="effect-inset"></div>').appendTo("body"),z="text"==x.css("background-clip");x.remove();var C=_.template('<div class="edit-h"></div>');return r}();
(function(b){function i(e,c){var g=this;this.request=$.ajax({url:(b.env.apiUrl||"")+"/api/"+e+(b.env.apiUrlSuffix||""),type:"post",data:JSON.stringify(c),dataType:"json",contentType:"application/json",success:function(b,c,e){b.success?g.trigger("success",b.data,c,e):(b.error&&a(b),g.trigger("error",b.data,c,e))},error:function(b,c,e){"abort"!=b.statusText&&(a(b),g.trigger("error",b,c,e))},complete:function(a,b,c){"abort"!=a.statusText&&g.trigger("complete",a,b,c)}})}function a(a){a="object"==typeof a.error?
a.error:{title:a.status+" "+a.statusText,msg:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430"};b.msg.alert({title:a.title,text:a.msg})}i.prototype=_.extend({abort:function(){this.request.abort();return this}},Backbone.Events);b.rpc={request:function(a,b){return new i(a,b)}}})(App);
App.defineView("Toolbar",{tagName:"div",className:"btn-toolbar",groupTpl:_.template('<div class="btn-group"></div>'),init:function(){},doRender:function(){this._groupsEl=this.$el;return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},add:function(b,i){i||(i=0);var a=this._groupsEl.find(">[data-index="+i+"]");0==a.length&&(a=$(this.groupTpl()).attr("data-index",i),this._groupsEl.children().each(function(){if($(this).data("index")>i)return a.insertBefore($(this)),!1}),0==
this._groupsEl.has(a).length&&this._groupsEl.append(a));a.append(b.$el);return this}});
App.defineView("ToolbarHover",{extend:"Toolbar",hoverTpl:_.template('<div class="b-toolbarhover effect-autohide"><div class="b-toolbarhover-h _toolbar{cid}"></div></div>'),init:function(){},doRender:function(){this.parent().doRender.apply(this,arguments);var b=$(this.hoverTpl({cid:this.cid}));this._toolbar=b.find("._toolbar"+this.cid).append(this.$el);this.$el=b;return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0);this.parent().doPresenter.apply(this,arguments);return this},
setPanel:function(b){this.$el.appendTo(b.$el||b);return this}});
App.defineView("Tooltip",{options:{text:"",target:null,position:"top",type:null,trigger:"hover"},init:function(){this._tooltip=$(this.options.target).tooltip({placement:this.options.position,trigger:this.options.trigger,title:this.options.text}).data("tooltip");this.options.type&&this._tooltip.tip().addClass("mod_"+this.options.type)},doRender:function(){this._items=this.$el.find("._items"+this.cid);return this},doPresenter:function(){this._presenterOnce||(this._presenterOnce=!0)},setText:function(b){if(this._tooltip.options.title==
b)return this;this._tooltip.options.title=b;this._tooltip.tip().is(":visible")&&this._tooltip.tip().find(".tooltip-inner").html(b);return this},hide:function(){this._tooltip.hide();return this},destroy:function(){this._tooltip.destroy();return this},show:function(){if(this._tooltip.tip().is(":visible"))return this;this._tooltip.show();return this}});
(function(b){function i(){if(this.collection){var a=this;this.collection.on("reset",function(){},this).on("add",function(b,c,e){g.call(a,b,e.index)},this).on("remove",function(b){t.call(a,b)},this)}}function a(){this._length=0;var a=this._bodyHEl.scrollTop(),b=this._bodyHEl.scrollLeft();this._bodyEl.children().remove();for(var c=this.collection.models,h=0;h<c.length;h++)g.call(this,c[h],h);e.call(this);this._bodyEl.fadeIn(200);this._bodyHEl.scrollTop(a).scrollLeft(b)}function e(){var a=0==this._length;
a!==this._isEmpty&&((this._isEmpty=a)?(this._emptyEl.fadeIn(200),this._bodyEl.hide(),b.view.applyInset(this._emptyEl)):(this._emptyEl.hide(),this._bodyEl.fadeIn(200)))}function c(a,b){var c=this._bodyEl.find('[data-id="'+(a.id||a.cid)+'"]'),e=this._bodyEl.find(">:eq("+b+")");0<e.length?c.insertBefore(e):c.appendTo(this._bodyEl)}function g(a,b){var c=this,g,i;g=h.call(this,a);this._length>b&&(i=this._bodyEl.find(">:eq("+b+")"));i&&0<i.length?g.insertBefore(i):g.appendTo(this._bodyEl);a.off("change",
null,this);a.on("change",function(){var b=h.call(c,a);g.replaceWith(b);g=b},this);this._length++;e.call(this)}function h(a){for(var b="",c,e=0;e<this._columns.length;e++)c=a.get(this._columns[e].key),this._columns[e].render&&(c=this._columns[e].render.call(this,c)),"boolean"==typeof c&&(c=c?'<i class="icon-ok"></i>':""),b+=r({cid:this.cid,text:c,align:this._columns[e].align||"left"});b=$(B({cid:this.cid,id:a.id||a.cid,items:b}));for(e=0;e<this._columns.length;e++)(c=this._columns[e].editor)&&p(b.find(">eq("+
e+")"),c,this._columns[e]);this._selectedRow==(a.id||a.cid)&&b.addClass("state_active");return b}function p(a,c,e){var g=this;a.on("click",function(){var b=m.call(g,a);b.id==this._selectedRow&&(c.setValue(b.get(e.key)),a.triggerHandler("edit"))});b.view.setEditor(a,c)}function m(a){return this.collection.get(a.closest("._row"+this.cid).data("id"))}function t(a){var b=this._bodyEl.find('>[data-id="'+(a.id||a.cid)+'"]');0!=b.length&&(b.is(":visible")?b.fadeOut(200,function(){$(this).remove()}):b.remove(),
this._length--,(a.id||a.cid)==this._selectedRow&&this.select(),e.call(this))}function q(a){if(a.editor)a.editor.on("change",function(){var b=this.model,c={};c[a.key]=this.getValue();(b=b.validate(c,{onlynew:!0}))?this.applyError(b[0].msg):this.clearError()}).on("eleditdone",function(b,c){m.call(this,b).set(a.key,c,{silent:!1})})}b.defineView("Grid",{options:{maxHeight:222,collection:null,collumns:null,selectable:!1,minColumnWidth:50,emptyText:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445",
autoFetch:!1},init:function(){this._length=0;this._columns=[]},doRender:function(){var a=this;this.$el=$(w({cid:this.cid,emptytext:this.options.emptyText}));this._colsEl=this.$el.find("._cols"+this.cid);this._headEl=this.$el.find("._head"+this.cid);this._headHEl=this.$el.find("._head-h"+this.cid);this._bodyEl=this.$el.find("._body"+this.cid).on("click","._row"+this.cid,function(){a.select($(this).data("id"))});this._bodyHEl=this.$el.find("._body-h"+this.cid).css("max-height",this.options.maxHeight).scroll(function(){a._headHEl.scrollLeft($(this).scrollLeft())});
this._emptyEl=this.$el.find("._empty"+this.cid);this._refreshButton=new (b.getView("Button"))({icon:"icon-refresh",type:"small",tooltip:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",click:function(){a.fetch()}});this._toolbar=new (b.getView("ToolbarHover"));this._toolbar.add(this._refreshButton,10).setPanel(this);this.options.reorderable&&(this._upButton=new (b.getView("Button"))({disabled:!0,icon:"icon-arrow-up",type:"small",tooltip:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u0432\u0435\u0440\u0445",
click:function(){var b=a._bodyEl.children().index(a._bodyEl.find('>[data-id="'+a._selectedRow+'"]'));if(0!=b){var d=a.collection.get(a._selectedRow);c.call(a,d,b-1);v.call(a,d,b-1)}}}),this._downButton=new (b.getView("Button"))({disabled:!0,icon:"icon-arrow-down",tooltip:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u043d\u0438\u0437",type:"small",click:function(){var b=a._bodyEl.children().index(a._bodyEl.find('>[data-id="'+a._selectedRow+'"]'));if(b!=a._length-1){var d=
a.collection.get(a._selectedRow);c.call(a,d,b+2);v.call(a,d,b+1)}}}),this._toolbar.add(this._upButton,9).add(this._downButton,9),this.on("selectionchange",function(a){a?(this._upButton.enable(),this._downButton.enable()):(this._upButton.disable(),this._downButton.disable())}));this.$el.on("mouseenter","._hover"+this.cid,function(){var c=$(this);c.data("tooltip")||(a._hoverAction=setTimeout(function(){c.css("position","absolute");var a=c.width();c.css("position","static");c.width()<a&&(a=c.data("tooltip"),
a||(a=new (b.getView("Tooltip"))({delay:{show:300},target:c,position:"top"}),c.data("tooltip",a)),a.setText(c.text()).show())},500))});this.$el.on("mouseleave","._hover"+this.cid,function(){clearTimeout(a._hoverAction)});var e=this.options.columns,g;this._columns=this._columns.concat(e);for(var h=0;h<e.length;h++)e[h].width=e[h].width||1,g=z({cid:this.cid,text:e[h].name,align:e[h].align||"left"}),q.call(this,e[h]),this._colsEl.last().append('<col class="_col'+this.cid+'"/>'),this._headEl.append(g);
this.setCollection(this.collection);return this},doPresenter:function(){this._presenterOnce||(this.on("remove",function(){this.collection&&this.collection.off(null,null,this)}),this._presenterOnce=!0);i.call(this)},doLayout:function(){for(var a=this._columns,c,e,g=b.view.getScrollbarWidth(),h=this.$el.width()-g,d=0,i=e=0;i<a.length;i++)c=a[i].width,10<c?(this._colsEl.find("._col"+this.cid+":eq("+i+")").css("width",c+"px"),e+=c):d+=c;e=h-e;for(i=0;i<a.length;i++)c=a[i].width,10>=c&&(c=Math.max(this.options.minColumnWidth,
parseInt(e*(c/d))),this._colsEl.find("._col"+this.cid+":eq("+i+")").css("width",c+"px"));this._headHEl.css("margin-right",g+"px");this._bodyHEl.find("table").width(h)},layout:function(){this.parent().layout.apply(this,arguments);this.collection&&!this.collection.isFetched()&&this.fetch();return this},getToolbar:function(){return this._toolbar},select:function(a){var b=this._selectedRow;if(this._selectedRow!==a)return this._selectedRow=a,this._bodyEl.find(">.state_active").removeClass("state_active").end().find('>[data-id="'+
a+'"]').addClass("state_active").end(),this.trigger("selectionchange",a,b),this},getSelection:function(){return this._selectedRow?[this._selectedRow]:[]},setCollection:function(b){var c=this;this.collection&&this.collection.off(null,null,this);this.collection=b;i.call(this);this.select();!b||b.isLocal()?this._refreshButton.disable():this._refreshButton.enable();setTimeout(function(){c.collection&&(c.collection.isFetched()||c.collection.isLocal()?a.call(c):c.$el.is(":visible")&&c.fetch())},0);return this},
fetch:function(){if(this.collection){var c=this;b.view.setLoading(c.$el,!0);this.collection.fetch({silent:!0,success:function(){a.call(c)},complete:function(){b.view.setLoading(c.$el,!1)}})}}});var v=b.debounce(function(a,b){this.trigger("moverow",a.id,b)},1E3,!1,!0),w=_.template('<div class="b-grid"><div class="b-grid-h"><div class="b-grid-head _head-h{cid} _head{cid} _cols{cid}"></div><div class="b-grid-body _body-h{cid}"><table class="table table-striped table-hover"><colgroup class="_cols{cid}"></colgroup><tbody class="_body{cid}"></tbody></table></div></div><div class="b-grid-empty _empty{cid}">{emptytext}</div></div>'),
z=_.template('<div class="b-grid-th align_{align} _col{cid}"><div class="b-grid-th-h _hover{cid}">{text}</div></div>'),B=_.template('<tr data-id={id} class="b-grid-row _row{cid}">{items}</tr>'),r=_.template('<td class="b-grid-td t-bg align_{align}"><div class="b-grid-td-h _td{cid} _hover{cid}">{text}</div></td>')})(App);
